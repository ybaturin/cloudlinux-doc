(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{450:function(t,e,s){"use strict";s.r(e);var a=s(2),n=Object(a.a)({},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"kernel-settings"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#kernel-settings","aria-hidden":"true"}},[t._v("#")]),t._v(" Kernel Settings")]),t._v(" "),s("p",[s("router-link",{attrs:{to:"/kernel_settings/#kernel-config-variables"}},[t._v("Kernel Config Variables")]),t._v(" "),s("router-link",{attrs:{to:"/kernel_settings/#virtualized-proc-filesystem"}},[t._v("Virtualized /proc filesystem")])],1),t._v(" "),s("p",[s("router-link",{attrs:{to:"/kernel_settings/#securelinks"}},[t._v("SecureLinks")])],1),t._v(" "),s("p",[s("router-link",{attrs:{to:"/kernel_settings/#symlink-owner-match-protection"}},[t._v("Symlink Owner Match Protection")])],1),t._v(" "),s("p",[s("router-link",{attrs:{to:"/kernel_settings/#link-traversal-protection"}},[t._v("Link Traversal Protection")])],1),t._v(" "),s("p",[s("router-link",{attrs:{to:"/kernel_settings/#ptrace-block"}},[t._v("ptrace Block")])],1),t._v(" "),s("p",[s("router-link",{attrs:{to:"/kernel_settings/#xen-xvda"}},[t._v("Xen XVDA detection")])],1),t._v(" "),s("p",[s("router-link",{attrs:{to:"/kernel_settings/#tpe-extension-deprecated"}},[t._v("TPE Extension")])],1),t._v(" "),s("p",[s("router-link",{attrs:{to:"/kernel_settings/#io-limits-latency"}},[t._v("IO Limits latency")])],1),t._v(" "),s("p",[s("router-link",{attrs:{to:"/kernel_settings/#hybrid-kernel"}},[t._v("Hybrid Kernel")])],1),t._v(" "),s("p",[s("router-link",{attrs:{to:"/kernel_settings/#reading-lve-usage"}},[t._v("Reading LVE usage")])],1),t._v(" "),s("p",[s("router-link",{attrs:{to:"/kernel_settings/#flashcache"}},[t._v("flashcache")])],1),t._v(" "),s("p",[s("router-link",{attrs:{to:"/kernel_settings/#oom-killer-for-lve-processes"}},[t._v("OOM Killer for LVE Processes")])],1),t._v(" "),s("p",[s("router-link",{attrs:{to:"/kernel_settings/#file-system-quotas"}},[t._v("File System Quotas")])],1),t._v(" "),s("h2",{attrs:{id:"kernel-config-variables"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#kernel-config-variables","aria-hidden":"true"}},[t._v("#")]),t._v(" Kernel Config Variables")]),t._v(" "),s("p",[t._v("Starting from "),s("strong",[t._v("lvemanager 4.0-25.5")]),t._v(" , "),s("strong",[t._v("lve-utils 3.0-21.2")]),t._v(" , and "),s("strong",[t._v("cagefs-6.1-26")]),t._v(" , CloudLinux OS utilities can read/write kernel config variables from a custom config /etc/sysctl.d/90-cloudlinux.conf (earlier, the parameters were read/written only from sysctl.conf ).")]),t._v(" "),s("p",[t._v("CloudLinux OS utilities get parameter by using "),s("em",[t._v("sysctl")]),t._v(" system utility. So for now, even if a config variable is not set in the "),s("em",[t._v("sysctl.conf")]),t._v(" and in the "),s("em",[t._v("/etc/sysctl.d")]),t._v(" config files, this variable will be read by "),s("em",[t._v("sysctl")]),t._v(" utility directly from "),s("em",[t._v("/proc/sys")]),t._v(" .")]),t._v(" "),s("p",[t._v("If some kernel variable was set in "),s("em",[t._v("/etc/sysctl.d/90-cloudlinux.conf")]),t._v(" do\n")]),s("div",{staticClass:"notranslate"},[s("p"),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("sysctl --system\n")])])])]),t._v("\nto apply the parameters before reading and after writing.\n"),s("p",[t._v("Starting from "),s("strong",[t._v("cagefs-6.1-27")]),t._v(",  fs.proc_can_see_other_uid will be migrated (one time) from /etc/sysctl.conf into /etc/sysctl.d/90-cloudlinux.conf . If this variable is not set in either file, it will default to 0.\nIt is strongly advised against setting this variable in 90-cloudlinux.conf . Define it in /etc/sysctl.conf or in some other config file with an index number greater than 90-cloudlinux.conf , e.g. /etc/sysctl.d/95-custom.conf .")]),t._v(" "),s("p",[t._v("Starting from "),s("strong",[t._v("lve-utils-3.0-23.7")]),t._v("  fs.proc_super_gid and fs.symlinkown_gid will be migrated (one time) from /etc/sysctl.conf into /etc/sysctl.d/90-cloudlinux.conf .")]),t._v(" "),s("p",[t._v("For "),s("strong",[t._v("lve-utils")]),t._v(" versions from 3.0-21.2 to 3.0-23.7 the migration was performed the same way, but during every package install/update.\nVariables setting guidelines are the same as for CageFS (see above).")]),t._v(" "),s("h2",{attrs:{id:"virtualized-proc-filesystem"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#virtualized-proc-filesystem","aria-hidden":"true"}},[t._v("#")]),t._v(" Virtualized /proc filesystem")]),t._v(" "),s("p",[t._v("You can prevent user from seeing processes of other users (via ps/top command) as well as special files in /proc file system by setting fs.proc_can_see_other_uid sysctl.")]),t._v(" "),s("p",[t._v("To do that, edit /etc/sysctl.conf\n")]),s("div",{staticClass:"notranslate"},[s("p"),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("fs.proc_can_see_other_uid=0\nfs.proc_super_gid=600\n")])])])]),t._v("\nAnd do:\n"),s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("# sysctl -p\n")])])])]),t._v("\nfs.proc_can_see_other_uid=0\n"),s("p",[t._v("If fs.proc_can_see_other_uid is set to 0, users will not be able to see special files. If it is set to 1 - user will see other processes IDs in /proc filesystem.")]),t._v(" "),s("p",[t._v("fs.proc_super_gid=XX")]),t._v(" "),s("p",[t._v("The fs.proc_super_gid sets group ID which will see system files in /proc, add any users to that group so they will see all files in /proc. Usually needed by some monitoring users like nagios or zabbix and "),s("router-link",{attrs:{to:"/limits/#cldetect"}},[t._v("cldetect utility")]),t._v(" can configure few most commonly used monitoring software automatically.")],1),t._v(" "),s("p",[t._v("Virtualized /proc filesystem will only display following files (as well as directories for PIDs for the user) to unprivileged users:\n")]),s("div",{staticClass:"notranslate"},[s("p"),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("/proc/cpuinfo\n/proc/version\n/proc/stat\n/proc/uptime\n/proc/loadavg\n/proc/filesystems\n/proc/stat\n/proc/cmdline\n/proc/meminfo\n/proc/mounts\n/proc/tcp\n/proc/tcp6\n/proc/udp\n/proc/udp6\n/proc/assocs\n/proc/raw\n/proc/raw6\n/proc/unix\n/proc/dev\n")])])])]),t._v(" "),s("p",[t._v(":::tip Note\nStarting from lve-utils 3.0-21.2, fs.proc_super_gid parameter in da_add_admin utility is written to /etc/sysctl.d/90-cloudlinux.conf.\n:::")]),t._v(" "),s("h1",{attrs:{id:"remounting-procfs-with-hidepid-option"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#remounting-procfs-with-hidepid-option","aria-hidden":"true"}},[t._v("#")]),t._v(' Remounting procfs with "hidepid" option')]),t._v(" "),s("p",[t._v("In "),s("strong",[t._v("lve-utils-2.1-3.2")]),t._v(" and later "),s("em",[t._v("/proc")]),t._v(" can be remounted with "),s("code",[t._v("hidepid=2")]),t._v(" option to enable additional protection for procfs. This remount is performed in lve_namespaces service.\nThis option is in sync with "),s("em",[t._v("fs.proc_can_see_other_uid")]),t._v(" kernel parameter described above.\nWhen "),s("em",[t._v("/etc/sysctl.conf")]),t._v(" does not contain "),s("em",[t._v("fs.proc_can_see_other_uid")]),t._v(" setting, the protection is off (procfs is remounted with "),s("em",[t._v("hidepid=0")]),t._v(" option). In this case "),s("em",[t._v("fs.proc_super_gid")]),t._v(" setting is ignored. Users are able to see full "),s("em",[t._v("/proc")]),t._v(" including processes of other users on a server. This is a default behavior.")]),t._v(" "),s("p",[t._v("If "),s("em",[t._v("/etc/sysctl.conf")]),t._v(" contains "),s("em",[t._v('"fs.proc_can_see_other_uid=1"')]),t._v(" setting, then /proc will be remounted with "),s("em",[t._v('"hidepid=0"')]),t._v(" option (disable "),s("em",[t._v("“hidepid”")]),t._v(" protection for all users).\nIf "),s("em",[t._v("/etc/sysctl.conf")]),t._v(" contains "),s("em",[t._v('"fs.proc_can_see_other_uid=0"')]),t._v(" setting, then /proc will be remounted with "),s("em",[t._v('"hidepid=2"')]),t._v(" option (enable "),s("em",[t._v("“hidepid”")]),t._v(" protection for all users).\nIf "),s("em",[t._v("/etc/sysctl.conf")]),t._v(" contains "),s("em",[t._v('"fs.proc_can_see_other_uid=0"')]),t._v(" and "),s("em",[t._v('"fs.proc_super_gid=$GID"')]),t._v(" settings, then "),s("em",[t._v("/proc")]),t._v(" will be remounted with "),s("em",[t._v('"hidepid=2, gid=$GID"')]),t._v(" options (enable "),s("em",[t._v("“hidepid”")]),t._v(" for all users except users in group with gid $GID).")]),t._v(" "),s("p",[t._v("To apply /etc/sysctl.conf changes, you should execute\n")]),s("div",{staticClass:"notranslate"},[s("p"),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("service lve_namespaces restart\n")])])])]),t._v("\n Or\n"),s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("/usr/share/cloudlinux/remount_proc.py\n")])])])]),t._v(" "),s("p",[t._v("So, admin can prevent users from seeing processes of other users via "),s("em",[t._v('"fs.proc_can_see_other_uid"')]),t._v(" and "),s("em",[t._v('"fs.proc_super_gid"')]),t._v(" settings in "),s("em",[t._v("/etc/sysctl.conf")]),t._v(" , like earlier.")]),t._v(" "),s("p",[t._v("Also, you can override this by specifying desired options for "),s("em",[t._v("/proc")]),t._v(" in "),s("em",[t._v("/etc/fstab")]),t._v(" .")]),t._v(" "),s("p",[t._v("To disable hidepid, add to "),s("em",[t._v("/etc/fstab")]),t._v(" the following:\n")]),s("div",{staticClass:"notranslate"},[s("p"),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("proc /proc proc defaults,hidepid=0,gid=0 0 0\n")])])])]),t._v("\nOr you can specify desired hidepid and gid values explicitly:\n"),s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("proc /proc proc defaults,hidepid=2,gid=clsupergid 0 0\n")])])])]),t._v("\n You should execute\n"),s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("mount -o remount /proc\n")])])])]),t._v(" "),s("p",[t._v("to apply "),s("em",[t._v("/etc/fstab")]),t._v(" changes."),s("br"),t._v("\nNevertheless, we recommend to manage procfs mount options via "),s("em",[t._v("/etc/sysctl.conf")]),t._v(" as described above for backward compatibility.")]),t._v(" "),s("p",[t._v("::: tip Note\nThere is a known issue on CloudLinux 6 systems. User cannot see full /proc inside CageFS even when this user is in “super” group, that should see full /proc. This issue does not affect users with CageFS disabled. CloudLinux 7 is not affected.\n:::")]),t._v(" "),s("p",[t._v("::: tip Note\nStarting from lve-utils 3.0-21.2, lve_namespaces service can read parameters from the /etc/sysctl.d/90-cloudlinux.conf.\n:::")]),t._v(" "),s("p",[t._v("::: tip Note\nEven if fs.proc_can_see_other_uid and fs.proc_super_gid parameters are not set in config files but specified in /proc/sys, then when restarting lve_namespaces service the parameters from /proc/sys will be used. So, /proc will be remounted according to these parameters.\n:::")]),t._v(" "),s("h2",{attrs:{id:"securelinks"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#securelinks","aria-hidden":"true"}},[t._v("#")]),t._v(" SecureLinks")]),t._v(" "),s("p",[t._v("CloudLinux provides comprehensive protection against symbolic link attacks popular in shared hosting environment.")]),t._v(" "),s("p",[t._v("The protection requires setting multiple kernel options to be enabled.")]),t._v(" "),s("h3",{attrs:{id:"symlink-owner-match-protection"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#symlink-owner-match-protection","aria-hidden":"true"}},[t._v("#")]),t._v(" Symlink Owner Match Protection")]),t._v(" "),s("p",[s("strong",[s("em",[t._v("fs.enforce_symlinksifowner")])])]),t._v(" "),s("p",[t._v("To protect against symlink attack where attacker tricks Apache web server to read some other user PHP config files, or other sensitive file, enable:\n")]),s("div",{staticClass:"notranslate"},[s("p"),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("fs.enforce_symlinksifowner=1\n")])])])]),t._v(" "),s("p",[t._v("Setting this option will deny any process running under gid "),s("em",[t._v("fs.symlinkown_gid")]),t._v(" to follow the symlink if owner of the link doesn’t match the owner of the target file.")]),t._v(" "),s("p",[t._v("Defaults:\n")]),s("div",{staticClass:"notranslate"},[s("p"),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("fs.enforce_symlinksifowner = 1\nfs.symlinkown_gid = 48\n")])])])]),t._v(" "),s("table",[s("thead",[s("tr",[s("th"),t._v(" "),s("th")])]),t._v(" "),s("tbody",[s("tr",[s("td",[s("span",{staticClass:"notranslate"},[s("em",[t._v("fs.enforce_symlinksifowner = 0")])])]),t._v(" "),s("td",[t._v("do not check "),s("span",{staticClass:"notranslate"},[t._v(" symlink ")]),t._v(" ownership")])]),t._v(" "),s("tr",[s("td",[s("span",{staticClass:"notranslate"},[s("em",[t._v("fs.enforce_symlinksifowner = 1")])])]),t._v(" "),s("td",[t._v("deny if "),s("span",{staticClass:"notranslate"},[t._v(" symlink ")]),t._v(" ownership doesn’t match target, and process "),s("span",{staticClass:"notranslate"},[t._v(" gid ")]),t._v(" matches "),s("span",{staticClass:"notranslate"},[t._v(" _symlinkown_gid _ ")])])])])]),t._v(" "),s("p",[t._v("When "),s("span",{staticClass:"notranslate"},[s("em",[t._v("fs.enforce_symlinksifowner")])]),t._v(" set to 1, processes with "),s("span",{staticClass:"notranslate"},[t._v(" GID ")]),t._v(" 48 will not be able to follow "),s("span",{staticClass:"notranslate"},[t._v(" symlinks ")]),t._v(" if they are owned by "),s("span",{staticClass:"notranslate"},[t._v(" user1 ")]),t._v(" , but point to file owned "),s("span",{staticClass:"notranslate"},[t._v(" user2 ")]),t._v(" .")]),t._v(" "),s("p",[t._v("Please, note that "),s("span",{staticClass:"notranslate"},[s("em",[t._v("fs.enforce_symlinksifowner = 2")])]),t._v(" is deprecated and can cause issues for the system operation.\n"),s("span",{staticClass:"notranslate"})]),t._v(" "),s("p",[s("strong",[s("em",[t._v("fs.symlinkown_gid")])])]),t._v(" "),s("p",[t._v("On standard "),s("span",{staticClass:"notranslate"},[t._v(" RPM Apache ")]),t._v(" installation, "),s("span",{staticClass:"notranslate"},[t._v(" Apache ")]),t._v(" is usually running under "),s("span",{staticClass:"notranslate"},[t._v(" GID ")]),t._v(" 48.\nOn "),s("span",{staticClass:"notranslate"},[t._v(" cPanel ")]),t._v(" servers, "),s("span",{staticClass:"notranslate"},[t._v(" Apache ")]),t._v(" is running under user nobody, "),s("span",{staticClass:"notranslate"},[t._v(" GID ")]),t._v(" 99.")]),t._v(" "),s("p",[t._v("To change "),s("span",{staticClass:"notranslate"},[t._v(" GID ")]),t._v(" of processes that cannot follow "),s("span",{staticClass:"notranslate"},[t._v(" symlink ")]),t._v(" , edit the file "),s("span",{staticClass:"notranslate"},[s("em",[t._v("/etc/sysctl.conf")])]),t._v(" , add the line:\n")]),s("div",{staticClass:"notranslate"},[s("p"),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("fs.symlinkown_gid = XX\n")])])])]),t._v("\nAnd execute:\n"),s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("$ sysctl -p\n")])])])]),t._v(" "),s("p",[t._v("To disable "),s("span",{staticClass:"notranslate"},[t._v(" symlink ")]),t._v(" owner match protection feature, set "),s("span",{staticClass:"notranslate"},[s("em",[t._v("fs.enforce_symlinksifowner = 0")])]),t._v(" in "),s("span",{staticClass:"notranslate"},[s("em",[t._v("/etc/sysctl.conf")])]),t._v(" , and execute")]),t._v(" "),s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("$ sysctl -p\n")])])])]),t._v(" "),s("p",[t._v("::: danger\n/proc/sys/fs/global_root_enable [CloudLinux 7 kernel only] [applicable for kernels 3.10.0-427.36.1.lve1.4.42+]\n:::")]),t._v(" "),s("p",[s("span",{staticClass:"notranslate"},[s("em",[t._v("proc/sys/fs/global_root_enable")])]),t._v(" flag enables following the "),s("span",{staticClass:"notranslate"},[t._v(" symlink ")]),t._v(" with root ownership. If "),s("span",{staticClass:"notranslate"},[s("em",[t._v("global_root_enable=0")])]),t._v(" , then "),s("span",{staticClass:"notranslate"},[t._v(" Symlink Owner Match Protection ")]),t._v(" does not verify the "),s("span",{staticClass:"notranslate"},[t._v(" symlink ")]),t._v(" owned by "),s("span",{staticClass:"notranslate"},[t._v(" root.  ")])]),t._v(" "),s("p",[t._v("For example, in the path "),s("span",{staticClass:"notranslate"},[s("em",[t._v("/proc/self/fd")]),t._v(" ,  "),s("em",[t._v("self")])]),t._v(" is a "),s("span",{staticClass:"notranslate"},[t._v(" symlink ")]),t._v(" , which leads to a process directory.  The "),s("span",{staticClass:"notranslate"},[t._v(" symlink ")]),t._v(" owner is "),s("span",{staticClass:"notranslate"},[t._v(" root ")]),t._v(" . When "),s("span",{staticClass:"notranslate"},[s("em",[t._v("global_root_enable=0")]),t._v(" , Symlink Owner Match Protection ")]),t._v(" excludes this element from the verification. When "),s("span",{staticClass:"notranslate"},[s("em",[t._v("global_root_enable=1")])]),t._v(" , the verification will be performed, which could block the access to "),s("em",[t._v("fd")]),t._v(" and cause violation of web site performance.")]),t._v(" "),s("p",[t._v("It is recommended to set "),s("em",[t._v("/proc/sys/fs/global_root_enable=0")]),t._v(" by default. If needed, set "),s("em",[t._v("/proc/sys/fs/global_root_enable=1")]),t._v(" to increase the level of protection.")]),t._v(" "),s("p",[t._v("::: tip Note\nStarting from lve-utils 3.0-21.2, fs.symlinkown_gid parameter values for httpd service user and fs.proc_super_gid for nagios service user is written to /etc/sysctl.d/90-cloudlinux.conf.\n:::")]),t._v(" "),s("h3",{attrs:{id:"link-traversal-protection"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#link-traversal-protection","aria-hidden":"true"}},[t._v("#")]),t._v(" Link Traversal Protection")]),t._v(" "),s("p",[s("span",{staticClass:"notranslate"},[s("router-link",{attrs:{to:"/cagefs/"}},[t._v("CageFS")])],1),t._v(" is extremely powerful at stopping most information disclosure attacks, where a hacker could read sensitive files like "),s("span",{staticClass:"notranslate"},[s("em",[t._v("/etc/passwd")])]),t._v(" .")]),t._v(" "),s("p",[t._v("Yet, "),s("span",{staticClass:"notranslate"},[t._v(" CageFS ")]),t._v(" does not work in each and every situation. For example, on "),s("span",{staticClass:"notranslate"},[t._v(" cPanel ")]),t._v(" servers, it is not enabled in "),s("span",{staticClass:"notranslate"},[t._v(" WebDAV ")]),t._v(" server, "),s("span",{staticClass:"notranslate"},[t._v(" cPanel ")]),t._v(" file manager and webmail, as well as some FTP servers don’t include proper change rooting.")]),t._v(" "),s("p",[t._v("This allows an attacker to create symlink or hardlink to a sensitive file like "),s("span",{staticClass:"notranslate"},[s("em",[t._v("/etc/passwd")])]),t._v(" and then use "),s("span",{staticClass:"notranslate"},[t._v(" WebDAV ")]),t._v(" , filemanager, or webmail to read the content of that file.")]),t._v(" "),s("p",[t._v("Starting with CL6 "),s("em",[t._v("kernel 2.6.32-604.16.2.lve1.3.45")]),t._v(" , you can prevent such attacks by preventing user from creating symlinks and hardlinks to files that they don’t own.")]),t._v(" "),s("p",[t._v("This is done by set following kernel options to 1:\n")]),s("div",{staticClass:"notranslate"},[s("p"),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("fs.protected_symlinks_create = 1\nfs.protected_hardlinks_create = 1\n")])])])]),t._v(" "),s("p",[t._v("::: danger\nWe do not recommend to use protected_symlinks option for cPanel users as it might break some of the cPanel functionality.\n:::")]),t._v(" "),s("p",[t._v("::: tip Note\nLink Traversal Protection is disabled by default for the new CloudLinux OS installations/convertations.\n:::")]),t._v(" "),s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("fs.protected_symlinks_create = 0\nfs.protected_hardlinks_create = 0\n")])])])]),t._v("\nThen setup:\n"),s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("fs.protected_symlinks_allow_gid = id_of_group_linksafe\nfs.protected_hardlinks_allow_gid = id_of_group_linksafe\n")])])])]),t._v("\nThis is for example needed by PHP Selector to work (new versions of Alt-PHP can already correctly configure those settings).\n"),s("p",[t._v("To manually adjust the settings, edit: "),s("em",[t._v("/etc/sysctl.d/cloudlinux-linksafe.conf")]),t._v("\nand execute:\n")]),s("div",{staticClass:"notranslate"},[s("p"),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("sysctl -p /etc/sysctl.d/cloudlinux-linksafe.conf\n")])])])]),t._v("\n or:\n"),s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("sysctl --system\n")])])])]),t._v(" "),s("p",[t._v(":::tip Note\nStarting from lvemanager 4.0-25.5, if there is no /etc/sysctl.d/cloudlinux-linksafe.conf config file, selectorctl for PHP with --setup-without-cagefs and --revert-to-cagefs keys writes fs.protected_symlinks_create and fs.protected_hardlinks_create parameters to /etc/sysctl.d/90-cloudlinux.conf.\n:::")]),t._v(" "),s("h2",{attrs:{id:"ptrace-block"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ptrace-block","aria-hidden":"true"}},[t._v("#")]),t._v(" ptrace Block")]),t._v(" "),s("p",[t._v("Starting with kernel 3.10.0-427.18.s2.lve1.4.21 ( "),s("span",{staticClass:"notranslate"},[t._v(" CloudLinux ")]),t._v(" 7) and 2.6.32-673.26.1.lve1.4.17 ( "),s("span",{staticClass:"notranslate"},[t._v(" CloudLinux ")]),t._v(" 6) we re-implemented "),s("span",{staticClass:"notranslate"},[t._v(" ptrace block ")]),t._v(" to protect against "),s("span",{staticClass:"notranslate"},[t._v(" ptrace ")]),t._v(" family of vulnerabilities. It prevents end user from using any "),s("span",{staticClass:"notranslate"},[t._v(" ptrace ")]),t._v(" related functionality, including such commands as "),s("span",{staticClass:"notranslate"},[t._v(" strace, lsof ")]),t._v(" or "),s("span",{staticClass:"notranslate"},[t._v(" gdb ")]),t._v(" .")]),t._v(" "),s("p",[t._v("By default, "),s("span",{staticClass:"notranslate"},[t._v(" CloudLinux ")]),t._v(" doesn't prevent "),s("span",{staticClass:"notranslate"},[t._v(" ptrace ")]),t._v(" functionality.")]),t._v(" "),s("p",[t._v("Defaults:\n")]),s("div",{staticClass:"notranslate"},[s("p"),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("kernel.user_ptrace = 1\nkernel.user_ptrace_self = 1\n")])])])]),t._v(" "),s("p",[t._v("The option "),s("span",{staticClass:"notranslate"},[t._v(" kernel.user_ptrace ")]),t._v(" disables "),s("span",{staticClass:"notranslate"},[t._v(" PTRACE_ATTACH ")]),t._v(" functionality, option "),s("span",{staticClass:"notranslate"},[t._v(" kernel.user_ptrace_self ")]),t._v(" disables "),s("span",{staticClass:"notranslate"},[t._v(" PTRACE_TRACEME ")]),t._v(" .")]),t._v(" "),s("p",[t._v("To disable all "),s("span",{staticClass:"notranslate"},[t._v(" ptrace ")]),t._v(" functionality change both "),s("span",{staticClass:"notranslate"},[t._v(" sysctl ")]),t._v(" options to 0, add this section to "),s("span",{staticClass:"notranslate"},[t._v(" /etc/sysctl.conf ")]),t._v(" :\n")]),s("div",{staticClass:"notranslate"},[s("p"),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("## CL. Disable ptrace for users\nkernel.user_ptrace = 0\nkernel.user_ptrace_self = 0\n##\n")])])])]),t._v(" "),s("p",[t._v("Apply changes with:\n")]),s("div",{staticClass:"notranslate"},[s("p"),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("$ sysctl -p\n")])])])]),t._v(" "),s("p",[t._v("Different software could need different access to "),s("span",{staticClass:"notranslate"},[t._v(" ptrace ")]),t._v(" , you may need to change only one option to 0 to make them working. In this case, there will be only partial "),s("span",{staticClass:"notranslate"},[t._v(" ptrace ")]),t._v(" protection.")]),t._v(" "),s("p",[t._v("::: danger\nptrace protection is known to break PSA service for Plesk 11\n:::")]),t._v(" "),s("h2",{attrs:{id:"xen-xvda"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#xen-xvda","aria-hidden":"true"}},[t._v("#")]),t._v(" Xen XVDA")]),t._v(" "),s("p",[t._v("2.6.32 kernels have different mode of naming "),s("span",{staticClass:"notranslate"},[t._v(" Xen XVDA ")]),t._v(" drives.")]),t._v(" "),s("p",[t._v("By adding "),s("span",{staticClass:"notranslate"},[t._v(" xen_blkfront.sda_is_xvda=0 ")]),t._v(" to kernel boot line in "),s("span",{staticClass:"notranslate"},[t._v(" grub.conf ")]),t._v(" you will make sure no naming translation is done, and the drives will be identified as "),s("span",{staticClass:"notranslate"},[t._v(" xvde ")]),t._v(" .")]),t._v(" "),s("p",[t._v("By default, this option is set to 1 in the kernel, and drives are detected as "),s("span",{staticClass:"notranslate"},[t._v(" xvda ")]),t._v(" .\nThis is needed only for CloudLinux 6 and "),s("span",{staticClass:"notranslate"},[t._v(" Hybrid ")]),t._v(" kernels.")]),t._v(" "),s("h2",{attrs:{id:"tpe-extension-deprecated"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#tpe-extension-deprecated","aria-hidden":"true"}},[t._v("#")]),t._v(" TPE Extension (deprecated)")]),t._v(" "),s("p",[s("em",[t._v("TPE Extension will removed in the next version of CloudLinux 5.x kernel")])]),t._v(" "),s("p",[s("span",{staticClass:"notranslate"},[t._v(" CloudLinux 5.x (kernel 2.6.18) has limited support for trusted path execution extension. ")]),t._v(" "),s("span",{staticClass:"notranslate"},[t._v(" CloudLinux 6.x (kernel 2.6.32) and  "),s("span",{staticClass:"notranslate"},[t._v(" CloudLinux 5.x with hybrid kernel don't have  "),s("span",{staticClass:"notranslate"},[t._v(" TPE extension ")])])])]),t._v(" "),s("p",[s("strong",[t._v("TPE (Trusted Path Execution)")])]),t._v(" "),s("p",[t._v("The kernel supports "),s("span",{staticClass:"notranslate"},[t._v(" TPE ")]),t._v(" feature out of the box. You can configure it using following files:\n")]),s("div",{staticClass:"notranslate"},[s("p"),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("·        /proc/sys/kernel/grsecurity/grsec_lock\n·        /proc/sys/kernel/grsecurity/tpe\n·        /proc/sys/kernel/grsecurity/tpe_gid\n·        /proc/sys/kernel/grsecurity/tpe_restrict_all\n")])])])]),t._v(" "),s("p",[t._v("To enable "),s("span",{staticClass:"notranslate"},[t._v(" TPE ")]),t._v(" feature in a standard way just add following to the end of your "),s("span",{staticClass:"notranslate"},[t._v(" /etc/sysctl.conf ")])]),s("div",{staticClass:"notranslate"},[s("p"),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("#GRsecurity \nkernel.grsecurity.tpe = 1 \nkernel.grsecurity.tpe_restrict_all = 1 \nkernel.grsecurity.grsec_lock = 1  \n")])])])]),t._v(" "),s("p",[t._v("And do:\n")]),s("div",{staticClass:"notranslate"},[s("p"),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("# sysctl -p\n")])])])]),t._v(" "),s("p",[t._v("::: tip Note\nOnce you set grsec_lock to 1, you will not be able to change TPE options without reboot.\n:::")]),t._v(" "),s("p",[t._v("This "),s("span",{staticClass:"notranslate"},[t._v(" Trusted Path Execution ")]),t._v(" feature was adopted from "),s("span",{staticClass:"notranslate"},[t._v(" grsecurity")]),t._v(".")]),t._v(" "),s("h2",{attrs:{id:"io-limits-latency"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#io-limits-latency","aria-hidden":"true"}},[t._v("#")]),t._v(" IO Limits Latency")]),t._v(" "),s("p",[s("strong",[t._v("[lve1.2.29+]")])]),t._v(" "),s("p",[t._v("When customer reaches "),s("span",{staticClass:"notranslate"},[t._v(" IO Limit, the processes that are waiting for  "),s("span",{staticClass:"notranslate"},[t._v(" IO will be placed to sleep to make sure they don't go over the limit. That could make some processes sleep for a very long time. ")])]),t._v("\nBy defining "),s("span",{staticClass:"notranslate"},[t._v(" IO latency, you can make sure that no process sleeps due to  "),s("span",{staticClass:"notranslate"},[t._v(" IO limit for more then X milliseconds. By doing so, you will also let customers to burst through the limits, and use up more than they were limited too in some instances. ")])])]),t._v(" "),s("p",[t._v("This option is "),s("span",{staticClass:"notranslate"},[t._v(" OFF by default. ")])]),t._v(" "),s("p",[s("em",[t._v("For CloudLinux 6 and CloudLinux 7 (since Hybrid kernel lve1.4.x.el5h):")])]),t._v(" "),s("p",[t._v("To enable "),s("span",{staticClass:"notranslate"},[t._v(" IO ")]),t._v(" Limits latency and set it to 10 seconds:\n")]),s("div",{staticClass:"notranslate"},[s("p"),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("# echo 10000 > /sys/module/kmodlve/parameters/latency\n")])])])]),t._v("\nTo disable latency:\n"),s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("# echo 2000000000 > /sys/module/kmodlve/parameters/latency\n")])])])]),t._v(" "),s("p",[t._v("It is possible to set, for example, 1000 as a permanent value. To do so, create a file "),s("span",{staticClass:"notranslate"},[t._v("/etc/modprobe.d/kmodlve.conf ")]),t._v(" with the following content:"),s("br"),t._v(" "),s("span",{staticClass:"notranslate"},[s("code",[t._v("options kmodlve latency=1000")])])]),t._v(" "),s("p",[s("em",[t._v("For "),s("span",{staticClass:"notranslate"},[t._v(" CloudLinux ")]),t._v(" 5 (OBSOLETE):")])]),t._v(" "),s("p",[t._v("To enable "),s("span",{staticClass:"notranslate"},[t._v(" IO ")]),t._v(" Limits latency and set it to 10 seconds:\n")]),s("div",{staticClass:"notranslate"},[s("p"),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("# echo 10000 > /sys/module/iolimits/**parameters/latency\n")])])])]),t._v("\nTo disable latency:\n"),s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("# echo 2000000000 > /sys/module/iolimits/**parameters/latency\n")])])])]),t._v(" "),s("h2",{attrs:{id:"hybrid-kernel"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#hybrid-kernel","aria-hidden":"true"}},[t._v("#")]),t._v(" Hybrid Kernel")]),t._v(" "),s("p",[s("span",{staticClass:"notranslate"},[s("strong",[t._v("CloudLinux 6 Hybrid kernel")])])]),t._v(" "),s("p",[s("span",{staticClass:"notranslate"},[t._v(" CloudLinux ")]),t._v(" 6 Hybrid Kernel is "),s("span",{staticClass:"notranslate"},[t._v(" CloudLinux ")]),t._v(" 7 (3.10.0) kernel compiled for CloudLinux 6 OS. New 3.10 kernel features a set of performance and scalability improvements related to  "),s("span",{staticClass:"notranslate"},[t._v(" IO ")]),t._v(" , networking and memory management, available in  "),s("span",{staticClass:"notranslate"},[t._v(" CloudLinux 7 OS ")]),t._v(" . It also features improved  "),s("span",{staticClass:"notranslate"},[t._v(" CPU ")]),t._v("  scheduler for better overall system throughput and latency.")]),t._v(" "),s("p",[t._v("Please find information on the main features of 3.10 kernel branch on the links:")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://kernelnewbies.org/Linux_3.10#head-e740f930dfd021616cc42e8abf21c79d0b07e217",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://kernelnewbies.org/Linux_3.10#head-e740f930dfd021616cc42e8abf21c79d0b07e217"),s("OutboundLink")],1)]),t._v(" "),s("p",[s("a",{attrs:{href:"https://www.kernel.org/pub/linux/kernel/v3.0/ChangeLog-3.10.1",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://www.kernel.org/pub/linux/kernel/v3.0/ChangeLog-3.10.1"),s("OutboundLink")],1)]),t._v(" "),s("p",[s("span",{staticClass:"notranslate"},[s("strong",[t._v("CloudLinux 7 Hybrid kernel")])])]),t._v(" "),s("p",[s("span",{staticClass:"notranslate"},[t._v(" CloudLinux ")]),t._v(" 7 Hybrid Kernel is essentially EL8-based (4.18) kernel compiled for CloudLinux OS 7.")]),t._v(" "),s("p",[t._v("You can find more information on 4.18 kernel branch using this link:")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/8.0_release_notes/new-features#kernel",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/8.0_release_notes/new-features#kernel"),s("OutboundLink")],1)]),t._v(" "),s("p",[t._v("How to migrate from the normal to hybrid channel ("),s("strong",[t._v("CL6h")]),t._v("):")]),t._v(" "),s("p",[t._v("::: tip Note\nThe system must be registered in CLN.\n:::")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("Update "),s("span",{staticClass:"notranslate"},[t._v(" rhn-client-tools ")]),t._v(" from production")])]),t._v(" "),s("li",[s("p",[t._v("Run "),s("span",{staticClass:"notranslate"},[t._v(" normal-to-hybrid ")]),t._v(" script.")])]),t._v(" "),s("li",[s("p",[t._v("Reboot after script execution is completed.")])])]),t._v(" "),s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("yum update rhn-client-tools\nnormal-to-hybrid\nreboot\n")])])])]),t._v(" "),s("p",[t._v("How to migrate from the normal to hybrid channel ("),s("strong",[t._v("CL7h")]),t._v("):")]),t._v(" "),s("p",[t._v("::: tip Note\nThe system must be registered in CLN.\n:::")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("Update "),s("span",{staticClass:"notranslate"},[t._v(" rhn-client-tools rhn-check rhn-setup ")]),t._v(" from testing repository")])]),t._v(" "),s("li",[s("p",[t._v("Run "),s("span",{staticClass:"notranslate"},[t._v(" normal-to-hybrid ")]),t._v(" script.")])]),t._v(" "),s("li",[s("p",[t._v("Reboot after script execution is completed.")])])]),t._v(" "),s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("yum update rhn-client-tools rhn-check rhn-setup --enablerepo=cloudlinux-updates-testing\nnormal-to-hybrid\nreboot\n")])])])]),t._v(" "),s("p",[t._v("How to migrate from hybrid to the normal channel (for both CL6h and CL7h):")]),t._v(" "),s("p",[t._v("::: tip Note\nThe system should be registered in CLN.\n:::")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("Run "),s("span",{staticClass:"notranslate"},[t._v(" hybrid-to-normal ")]),t._v(" script.")])]),t._v(" "),s("li",[s("p",[t._v("Reboot after script execution is completed.")])])]),t._v(" "),s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("hybrid-to-normal\nreboot\n")])])])]),t._v(" "),s("p",[s("strong",[t._v("Known limitations and issues of CloudLinux 6 Hybrid kernel")]),t._v(" :")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("We do not remove Hybrid kernel after migration from Hybrid to the normal channel, but we remove "),s("span",{staticClass:"notranslate"},[t._v(" linux-firmware ")]),t._v(" package which is needed to boot Hybrid kernel. This is because "),s("span",{staticClass:"notranslate"},[t._v(" CloudLinux ")]),t._v(" 6 does not allow to remove the package of currently running kernel. Proper removal procedure will be implemented, but for now, we should warn users "),s("em",[t._v("not to boot Hybrid kernel if they have migrated to normal channel")]),t._v(" .")])]),t._v(" "),s("li",[s("p",[t._v("Kernel module signature isn't checking for now, as 3.10 kernel is using x509 certificates to generate keys and CL6 cannot detect signatures created in such way. The solution will be implemented.")])])]),t._v(" "),s("p",[s("strong",[t._v("Known limitations and issues of CloudLinux 7 Hybrid kernel")])]),t._v(" "),s("p",[t._v("Features that are absent in the current kernel build:")]),t._v(" "),s("ol",[s("li",[t._v("CPU boost")]),t._v(" "),s("li",[t._v("CRIU support for mod_lsapi PRO")]),t._v(" "),s("li",[t._v("Per LVE traffic accounting")])]),t._v(" "),s("p",[t._v("Limitations of the current kernel build:")]),t._v(" "),s("ol",[s("li",[t._v("Standard OOM killer is used")]),t._v(" "),s("li",[t._v("The "),s("em",[t._v("/etc/sysctl.conf")]),t._v(" parameter "),s("span",{staticClass:"notranslate"},[s("code",[t._v("proc_can_see_other_uid")])]),t._v(" is supported but its behavior is more restrictive than "),s("router-link",{attrs:{to:"/kernel_settings/#virtualized-proc-filesystem"}},[t._v("documented")]),t._v(". This will be improved in the next beta release.")],1),t._v(" "),s("li",[t._v("Symlink Owner Match Protection is disabled by default. To enable it, use "),s("code",[t._v("sysctl")]),t._v(" utility:")])]),t._v(" "),s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("sysctl -w fs.enforce_symlinksifowner=1\n")])])])]),t._v(" "),s("p",[t._v("Find more details on "),s("router-link",{attrs:{to:"/kernel_settings/#securelinks"}},[t._v("symlink owner match protection")])],1),t._v(" "),s("h2",{attrs:{id:"reading-lve-usage"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#reading-lve-usage","aria-hidden":"true"}},[t._v("#")]),t._v(" Reading LVE Usage")]),t._v(" "),s("p",[t._v("CloudLinux kernel provides real time usage data in file.")]),t._v(" "),s("p",[t._v("All the statistics can be read from that file in real time. Depending on your kernel version you will get either Version 6 of the file, or version 4 of the file.\nYou can detect the version by reading the first line of the file. It should look like:")]),t._v(" "),s("p",[t._v("6:LVE... for version 6"),s("br"),t._v("\n4:LVE... for version 4")]),t._v(" "),s("p",[t._v("First line presents headers for the data.\nSecond line shows default limits for the server, with all other values being 0.\nThe rest of the lines present limits & usage data on per "),s("span",{staticClass:"notranslate"},[t._v(" LVE ")]),t._v(" bases.")]),t._v(" "),s("p",[t._v("Version 6 (CL6 & hybrid kernels):\n")]),s("div",{staticClass:"notranslate"},[s("p"),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("6:LVE        EP        lCPU        lIO        CPU        MEM        IO        lMEM        lEP        nCPU        fMEM        fEP        lMEMPHY        lCPUW        lNPROC        MEMPHY        fMEMPHY        NPROC        fNPROC\n0        0        25        1024        0        0        0        262144        20        1        0        0        262144        100        0        0        0        00\n300        0        25        1024        1862407        0        0        262144        20        1        0        0        262144        100        0        31        000\n")])])])]),t._v("\nVersion 4 (CL 5 kernel):\n"),s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("4:LVE        EP        lCPU        lIO        CPU        MEM        IO        lMEM        lEP        nCPU        fMEM        fEP\n0        0        25        25        0        0        0        262144        20        1        0        0\n300        0        25        25        15103019        0        0        262144        20        1        0        0\n")])])])]),t._v(" "),s("table",[s("thead",[s("tr",[s("th"),t._v(" "),s("th"),t._v(" "),s("th"),t._v(" "),s("th")])]),t._v(" "),s("tbody",[s("tr",[s("td",[s("strong",[t._v("Label")])]),t._v(" "),s("td",[s("strong",[t._v("Description")])]),t._v(" "),s("td",[s("strong",[t._v("Value")])]),t._v(" "),s("td",[s("strong",[t._v("Supported versions")])])]),t._v(" "),s("tr",[s("td",[s("span",{staticClass:"notranslate"},[t._v(" LVE ")])]),t._v(" "),s("td",[s("span",{staticClass:"notranslate"},[t._v(" LVE ID ")])]),t._v(" "),s("td",[t._v("number")]),t._v(" "),s("td")]),t._v(" "),s("tr",[s("td",[s("span",{staticClass:"notranslate"},[t._v(" EP ")])]),t._v(" "),s("td",[t._v("Number of "),s("span",{staticClass:"notranslate"},[t._v(" entry processes ")])]),t._v(" "),s("td",[t._v("number")]),t._v(" "),s("td")]),t._v(" "),s("tr",[s("td",[s("span",{staticClass:"notranslate"},[t._v(" lCPU ")])]),t._v(" "),s("td",[s("span",{staticClass:"notranslate"},[t._v(" CPU ")]),t._v(" Limit")]),t._v(" "),s("td",[t._v("% relative to total "),s("span",{staticClass:"notranslate"},[t._v(" CPU power ")])]),t._v(" "),s("td")]),t._v(" "),s("tr",[s("td",[s("span",{staticClass:"notranslate"},[t._v(" lIO ")])]),t._v(" "),s("td",[s("span",{staticClass:"notranslate"},[t._v(" IO ")]),t._v(" limits for CL6 or "),s("span",{staticClass:"notranslate"},[t._v(" IO ")]),t._v(" priority for CL5")]),t._v(" "),s("td",[t._v("KB/s for v6, from 1 to 100 for v4")]),t._v(" "),s("td")]),t._v(" "),s("tr",[s("td",[s("span",{staticClass:"notranslate"},[t._v(" CPU ")])]),t._v(" "),s("td",[s("span",{staticClass:"notranslate"},[t._v(" CPU ")]),t._v(" usage since reboot")]),t._v(" "),s("td",[t._v("in nanoseconds for v6, hertz for v4")]),t._v(" "),s("td")]),t._v(" "),s("tr",[s("td",[s("span",{staticClass:"notranslate"},[t._v(" MEM ")])]),t._v(" "),s("td",[t._v("Virtual memory usage")]),t._v(" "),s("td",[t._v("number of 4k pages")]),t._v(" "),s("td")]),t._v(" "),s("tr",[s("td",[s("span",{staticClass:"notranslate"},[t._v(" IO ")])]),t._v(" "),s("td",[s("span",{staticClass:"notranslate"},[t._v(" IO ")]),t._v(" usage")]),t._v(" "),s("td",[t._v("KB/s for v6, 0 for v4")]),t._v(" "),s("td")]),t._v(" "),s("tr",[s("td",[s("span",{staticClass:"notranslate"},[t._v(" lMEM ")])]),t._v(" "),s("td",[t._v("Virtual memory limit")]),t._v(" "),s("td",[t._v("number of 4k pages")]),t._v(" "),s("td")]),t._v(" "),s("tr",[s("td",[s("span",{staticClass:"notranslate"},[t._v(" lEP ")])]),t._v(" "),s("td",[s("span",{staticClass:"notranslate"},[t._v(" Entry Processes ")]),t._v(" limit")]),t._v(" "),s("td",[t._v("number")]),t._v(" "),s("td")]),t._v(" "),s("tr",[s("td",[s("span",{staticClass:"notranslate"},[t._v(" nCPU ")])]),t._v(" "),s("td",[t._v("Number of cores limit")]),t._v(" "),s("td",[t._v("number of cores")]),t._v(" "),s("td")]),t._v(" "),s("tr",[s("td",[s("span",{staticClass:"notranslate"},[t._v(" fMEM ")])]),t._v(" "),s("td",[s("span",{staticClass:"notranslate"},[t._v(" Virtual memory ")]),t._v(" faults")]),t._v(" "),s("td",[t._v("number of faults")]),t._v(" "),s("td")]),t._v(" "),s("tr",[s("td",[s("span",{staticClass:"notranslate"},[t._v(" fEP ")])]),t._v(" "),s("td",[s("span",{staticClass:"notranslate"},[t._v(" Entry Processes ")]),t._v(" faults")]),t._v(" "),s("td",[t._v("number of faults")]),t._v(" "),s("td",[t._v("v6+")])]),t._v(" "),s("tr",[s("td",[s("span",{staticClass:"notranslate"},[t._v(" lMEMPHY ")])]),t._v(" "),s("td",[t._v("Physical memory limit")]),t._v(" "),s("td",[t._v("number")]),t._v(" "),s("td",[t._v("v6+")])]),t._v(" "),s("tr",[s("td",[s("span",{staticClass:"notranslate"},[t._v(" lCPUW ")])]),t._v(" "),s("td",[s("span",{staticClass:"notranslate"},[t._v(" CPU ")]),t._v(" weight (not used)")]),t._v(" "),s("td",[t._v("from 1 to 100")]),t._v(" "),s("td",[t._v("v6+")])]),t._v(" "),s("tr",[s("td",[s("span",{staticClass:"notranslate"},[t._v(" lNPROC ")])]),t._v(" "),s("td",[s("span",{staticClass:"notranslate"},[t._v(" Number of processes ")]),t._v(" limit")]),t._v(" "),s("td",[t._v("number")]),t._v(" "),s("td",[t._v("v6+")])]),t._v(" "),s("tr",[s("td",[s("span",{staticClass:"notranslate"},[t._v(" MEMPHY ")])]),t._v(" "),s("td",[t._v("Physical memory usage")]),t._v(" "),s("td",[t._v("number of 4k pages")]),t._v(" "),s("td",[t._v("v6+")])]),t._v(" "),s("tr",[s("td",[s("span",{staticClass:"notranslate"},[t._v(" fMEMPHY ")])]),t._v(" "),s("td",[t._v("Physical memory faults")]),t._v(" "),s("td",[t._v("number of faults")]),t._v(" "),s("td",[t._v("v6+")])]),t._v(" "),s("tr",[s("td",[s("span",{staticClass:"notranslate"},[t._v(" NPROC ")])]),t._v(" "),s("td",[s("span",{staticClass:"notranslate"},[t._v(" Number of processes ")])]),t._v(" "),s("td",[t._v("number")]),t._v(" "),s("td",[t._v("v6+")])]),t._v(" "),s("tr",[s("td",[s("span",{staticClass:"notranslate"},[t._v(" fNPROC ")])]),t._v(" "),s("td",[s("span",{staticClass:"notranslate"},[t._v(" Number of processes ")]),t._v(" faults")]),t._v(" "),s("td",[t._v("number of faults")]),t._v(" "),s("td",[t._v("v6+")])]),t._v(" "),s("tr",[s("td",[s("span",{staticClass:"notranslate"},[t._v(" IOPS ")])]),t._v(" "),s("td",[s("span",{staticClass:"notranslate"},[t._v(" IO ")]),t._v(" operations since reboot")]),t._v(" "),s("td",[t._v("number")]),t._v(" "),s("td",[t._v("v8+")])])])]),t._v(" "),s("h2",{attrs:{id:"flashcache"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#flashcache","aria-hidden":"true"}},[t._v("#")]),t._v(" flashcache")]),t._v(" "),s("p",[s("em",[t._v("* Available only for x86_64, "),s("span",{staticClass:"notranslate"},[t._v(" CloudLinux ")]),t._v(" 6 and Hybrid servers")])]),t._v(" "),s("p",[s("span",{staticClass:"notranslate"},[t._v(" Flashcache ")]),t._v(" is a module originally written and released by "),s("span",{staticClass:"notranslate"},[t._v("  Facebook (Mohan Srinivasan, Paul Saab ")]),t._v(" and "),s("span",{staticClass:"notranslate"},[t._v(" Vadim Tkachenko ")]),t._v(" ) in April of 2010. It is a kernel module that allows Writethrough caching of a drive on another drive. This is most often used for caching a rotational drive on a smaller solid-state drive for performance reasons. This gives you the speed of an "),s("span",{staticClass:"notranslate"},[t._v(" SSD ")]),t._v(" and the size of a standard rotational drive for recently cached files. "),s("span",{staticClass:"notranslate"},[t._v(" Facebook ")]),t._v(" originally wrote the module to speed up database "),s("span",{staticClass:"notranslate"},[t._v(" I/O ")]),t._v(" , but it is easily extended to any "),s("span",{staticClass:"notranslate"},[t._v(" I/O ")]),t._v(" .")]),t._v(" "),s("p",[t._v("To install on "),s("span",{staticClass:"notranslate"},[t._v(" CloudLinux ")]),t._v(" 6 & Hybrid servers:\n")]),s("div",{staticClass:"notranslate"},[s("p"),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("$ yum install flashcache\n")])])])]),t._v(" "),s("p",[t._v("More info on "),s("span",{staticClass:"notranslate"},[t._v(" flashcache ")]),t._v(" : "),s("a",{attrs:{href:"https://github.com/facebook/flashcache/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/facebook/flashcache/"),s("OutboundLink")],1)]),t._v(" "),s("p",[s("span",{staticClass:"notranslate"},[t._v(" ArchLinux ")]),t._v(" has a good page explaining how to use "),s("span",{staticClass:"notranslate"},[t._v(" flashcache ")]),t._v(" :\n"),s("a",{attrs:{href:"https://wiki.archlinux.org/index.php/Flashcache",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://wiki.archlinux.org/index.php/Flashcache"),s("OutboundLink")],1)]),t._v(" "),s("h2",{attrs:{id:"oom-killer-for-lve-processes"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#oom-killer-for-lve-processes","aria-hidden":"true"}},[t._v("#")]),t._v(" OOM Killer for LVE Processes")]),t._v(" "),s("p",[t._v("When "),s("span",{staticClass:"notranslate"},[t._v(" LVE ")]),t._v(" reaches its memory limit, the processes inside that "),s("span",{staticClass:"notranslate"},[t._v(" LVE ")]),t._v(" are killed by "),s("span",{staticClass:"notranslate"},[t._v(" OOM Killer ")]),t._v(" and appropriate message is written to "),s("span",{staticClass:"notranslate"},[t._v(" /var/log/messages ")]),t._v(" . When any "),s("span",{staticClass:"notranslate"},[t._v(" LVE ")]),t._v(" hits huge number of memory limits in short period of time, then "),s("span",{staticClass:"notranslate"},[t._v(" OOM Killer ")]),t._v(" could cause system overload. Starting from kernel 2.6.32-673.26.1.lve1.4.15 ( "),s("span",{staticClass:"notranslate"},[t._v(" CloudLinux ")]),t._v(" 6) and from kernel 3.10.0-427.18.2.lve1.4.14 ( "),s("span",{staticClass:"notranslate"},[t._v(" CloudLinux ")]),t._v(" 7) heavy "),s("span",{staticClass:"notranslate"},[t._v(" OOM Killer ")]),t._v(" could be disabled. If so - lightweight "),s("span",{staticClass:"notranslate"},[t._v(" SIGKILL ")]),t._v(" will be used instead.")]),t._v(" "),s("p",[t._v("By default "),s("span",{staticClass:"notranslate"},[t._v(" OOM Killer ")]),t._v(" is enabled, to disable it please run:")]),t._v(" "),s("p",[s("em",[t._v("For "),s("span",{staticClass:"notranslate"},[t._v(" CloudLinux ")]),t._v(" 6")]),t._v(" :\n")]),s("div",{staticClass:"notranslate"},[s("p"),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("# echo 1 > /proc/sys/ubc/ubc_oom_disable\n")])])])]),t._v(" "),s("p",[t._v("Also, add the following to "),s("span",{staticClass:"notranslate"},[s("em",[t._v("/etc/sysctl.conf")])]),t._v(" file to apply the same during boot:\n")]),s("div",{staticClass:"notranslate"},[s("p"),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("ubc.ubc_oom_disable=1\n")])])])]),t._v(" "),s("p",[s("em",[t._v("For "),s("span",{staticClass:"notranslate"},[t._v(" CloudLinux ")]),t._v(" 7:")])]),s("div",{staticClass:"notranslate"},[s("p"),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("# echo 1 > /proc/sys/kernel/memcg_oom_disable\n")])])])]),t._v(" "),s("p",[t._v("Also, add the following to "),s("span",{staticClass:"notranslate"},[s("em",[t._v("/etc/sysctl.conf")])]),t._v(" file to apply the same during boot:\n")]),s("div",{staticClass:"notranslate"},[s("p"),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("kernel.memcg_oom_disable=1\n")])])])]),t._v(" "),s("h2",{attrs:{id:"file-system-quotas"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#file-system-quotas","aria-hidden":"true"}},[t._v("#")]),t._v(" File System Quotas")]),t._v(" "),s("p",[t._v("In "),s("span",{staticClass:"notranslate"},[s("strong",[t._v("Ext4")])]),t._v(" file system, the process with enabled capability "),s("span",{staticClass:"notranslate"},[t._v(" CAP_SYS_RESOURCE ")]),t._v(" is not checked on the quota exceeding by default. It allows userland utilities "),s("span",{staticClass:"notranslate"},[s("em",[t._v("selectorctl")])]),t._v(" and "),s("span",{staticClass:"notranslate"},[s("em",[t._v("cagefs")])]),t._v(" to operate without fails even if a user exceeds a quota.")]),t._v(" "),s("p",[t._v("To disable quota checking in "),s("span",{staticClass:"notranslate"},[s("strong",[t._v("XFS")])]),t._v(" file system set "),s("span",{staticClass:"notranslate"},[s("em",[t._v("cap_res_quota_disable")])]),t._v(" option to 1 using the following command:\n")]),s("div",{staticClass:"notranslate"},[s("p"),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("# echo 1 > /proc/sys/fs/xfs/cap_res_quota_disable\n")])])])])])},[],!1,null,null,null);e.default=n.exports}}]);