(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{460:function(t,e,a){"use strict";a.r(e);var s=a(2),r=Object(s.a)({},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"apache-mod-lsapi-pro"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#apache-mod-lsapi-pro","aria-hidden":"true"}},[t._v("#")]),t._v(" Apache mod_lsapi PRO")]),t._v(" "),a("p",[t._v("mod_lsapi PRO is an "),a("a",{attrs:{href:"https://httpd.apache.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Apache HTTP Server"),a("OutboundLink")],1),t._v(" module based on "),a("a",{attrs:{href:"https://www.litespeedtech.com/open-source/litespeed-sapi",target:"_blank",rel:"noopener noreferrer"}},[t._v("LiteSpeed Technologies API"),a("OutboundLink")],1),t._v(" . It serves to execute PHP scripts on a web-server by analogy with other modules like mod_suphp, php-fpm, mod_php. However, mod_lsapi PRO usage offers excellent PHP performance, low memory footprint coupled with great security and support for opcode caching.")]),t._v(" "),a("p",[a("strong",[t._v("How does it work?")])]),t._v(" "),a("ol",[a("li",[t._v("Apache passes handling for PHP request to mod_lsapi PRO;")]),t._v(" "),a("li",[t._v("mod_lsapi PRO use liblsapi to transfer request to lsphp parent process;")]),t._v(" "),a("li",[t._v("lsphp is forking child process which executes the request and returns data to mod_lsapi PRO;\n"),a("img",{attrs:{src:"/images/mod_lsapidiagrammnew.jpg",alt:""}}),a("br"),t._v(" "),a("em",[t._v("mod_lsapi PRO integrates with Apache, allows to handle concurrent requests and manages the lsphp processes")])])]),t._v(" "),a("ul",[a("li",[t._v("If there are no requests for lsapi_backend_pgrp_max_idle seconds, lsphp parent process will be  terminated;")]),t._v(" "),a("li",[t._v("If there are no lsphp child processes available when a new request comes, the new lsphp child process will be created;")]),t._v(" "),a("li",[t._v("lsphp childs process concurrent requests simultaneously;")]),t._v(" "),a("li",[t._v("The maximum number of simultaneously running lsphp child processes can be set by the lsapi_backend_children directive.")])]),t._v(" "),a("p",[a("strong",[t._v("What is lsphp?")])]),t._v(" "),a("p",[t._v("lsphp - PHP + LSAPI. What is PHP LSAPI? "),a("a",{attrs:{href:"https://www.litespeedtech.com/open-source/litespeed-sapi/php",target:"_blank",rel:"noopener noreferrer"}},[t._v("LiteSpeed Server Application Programming Interface"),a("OutboundLink")],1),t._v(" (LSAPI) is designed specifically for seamless, optimized communication between LiteSpeed Web Server and third-party web applications. Now with mod_lsapi PRO this protocol is available for Apache 2.2/2.4.")]),t._v(" "),a("p",[t._v("Using mod_lsapi PRO, we have seen the higher performance than Apache with mod_php, easier installation than php-fpm and easier integration with any control panel. mod_lsapi PRO means faster and more stable dynamic web pages.")]),t._v(" "),a("p",[a("strong",[t._v("Requirements")])]),t._v(" "),a("p",[t._v("Currently, the mod_lsapi is not compatible with:")]),t._v(" "),a("ul",[a("li",[t._v("Apache mod_ruid2 - should be disabled;")]),t._v(" "),a("li",[t._v("Apache mod_itk - should be disabled;")]),t._v(" "),a("li",[t._v("PHP-FPM - should be disabled because PHP-FPM is also a PHP Handler just as mod_lsapi.")])]),t._v(" "),a("p",[a("strong",[t._v("Optional requirements")])]),t._v(" "),a("ul",[a("li",[t._v("Configured "),a("router-link",{attrs:{to:"/limits/#understanding-lve"}},[t._v("LVE")]),t._v(" containers for end-users ( "),a("strong",[t._v("recommended - higher security level")]),t._v(" );")],1),t._v(" "),a("li",[t._v("Installed and configured "),a("router-link",{attrs:{to:"/limits/#hostinglimits"}},[t._v("mod_hostinglimits")]),t._v(" for Apache ( "),a("strong",[t._v("recommended - higher security level")]),t._v(" );")],1),t._v(" "),a("li",[t._v("Installed mod_suexec for Apache and configured "),a("a",{attrs:{href:"https://httpd.apache.org/docs/2.4/mod/mod_suexec.html#page-header",target:"_blank",rel:"noopener noreferrer"}},[t._v("SuExecUserGroup"),a("OutboundLink")],1),t._v(" directive for each virtual host ( "),a("strong",[t._v("recommended - higher security level")]),t._v(" );")]),t._v(" "),a("li",[t._v("Enabled "),a("router-link",{attrs:{to:"/cagefs/"}},[t._v("CageFS")]),t._v(" for end-users ( "),a("strong",[t._v("recommended - higher security level")]),t._v(" );")],1),t._v(" "),a("li",[a("router-link",{attrs:{to:"/php_selector/"}},[t._v("PHP Selector")]),t._v(" with alt-php - an easy way to select different PHP versions for each end-user provided by CloudLinux;")],1),t._v(" "),a("li",[t._v("ea-php - alternative to alt-php provided by cPanel (for cPanel only).")])]),t._v(" "),a("p",[a("strong",[t._v("Configuring mod_lsapi PRO")])]),t._v(" "),a("p",[t._v("In order to get mod_lsapi PRO work properly, you'll need to configure Apache. To do this, we use a separate "),a("em",[t._v("lsapi.conf")]),t._v(" file.")]),t._v(" "),a("p",[t._v("First of all, for the mod_lsapi PRO work, you need to ensure that the module is loaded. In your lsapi.conf you need to make sure the "),a("a",{attrs:{href:"http://httpd.apache.org/docs/current/mod/mod_so.html#loadmodule",target:"_blank",rel:"noopener noreferrer"}},[t._v("LoadModule"),a("OutboundLink")],1),t._v(" directive has not been commented out. A correctly configured directive may look like this:\n")]),a("div",{staticClass:"notranslate"},[a("p"),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("LoadModule lsapi_module modules/mod_lsapi.so\n")])])])]),t._v(" "),a("p",[t._v("In order to enable the module to process requests, you need to add the lsapi_engine directive to your "),a("em",[t._v("lsapi.conf")]),t._v(" file as follows:\n")]),a("div",{staticClass:"notranslate"},[a("p"),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("lsapi_engine On\n")])])])]),t._v(" "),a("p",[t._v("The mod_lsapi PRO handler can be enabled using the "),a("a",{attrs:{href:"https://httpd.apache.org/docs/2.4/mod/mod_mime.html#addtype",target:"_blank",rel:"noopener noreferrer"}},[t._v("AddType"),a("OutboundLink")],1),t._v(" directive. The AddType directive tells Apache that a given filename extension should be handled by mod_lsapi PRO. Apache will assume that and will attempt to execute it when that particular resource is requested by a client.\n")]),a("div",{staticClass:"notranslate"},[a("p"),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("AddType application/x-httpd-lsphp .php\n")])])])]),t._v(" "),a("p",[t._v("If no handler is explicitly set for a request, the specified content type will be used as the handler name, therefore, please disable php.conf or any other PHP handler for using mod_lsapi PRO. In this example application/x-httpd-lsphp is a default handler by which mod_lsapi PRO process requests with lsphp binary from "),a("em",[t._v("/usr/local/bin/")]),t._v(" directory.")]),t._v(" "),a("p",[t._v("The final lsapi.conf configuration might look like this:\n")]),a("div",{staticClass:"notranslate"},[a("p"),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("LoadModule lsapi_module modules/mod_lsapi.so\n\n\n<IfModule lsapi_module>      \n\tlsapi_engine On      \n\tAddType application/x-httpd-lsphp .php      \n\tlsapi_backend_connect_timeout 100000\n\tlsapi_backend_connect_tries 10\n\tlsapi_backend_children 20\n\tlsapi_backend_pgrp_max_idle 30\n\tlsapi_backend_max_process_time 300\n\tlsapi_debug Off\n</IfModule>\n")])])])]),t._v(" "),a("p",[t._v("In order to mod_lsapi PRO work lsapi.conf should be loaded to Apache through "),a("a",{attrs:{href:"https://httpd.apache.org/docs/2.4/mod/core.html#include",target:"_blank",rel:"noopener noreferrer"}},[t._v("Include"),a("OutboundLink")],1),t._v(" directive.")]),t._v(" "),a("p",[t._v("For more detailed description of the module directives please visit "),a("router-link",{attrs:{to:"/apache_mod_lsapi/#configuration-references"}},[t._v("Configuration reference")]),t._v("."),a("br"),t._v("\nFor installation guide mod_lsapi PRO please visit "),a("router-link",{attrs:{to:"/apache_mod_lsapi/#installation"}},[t._v("Installation")]),t._v(" .")],1),t._v(" "),a("h2",{attrs:{id:"configuration-references"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#configuration-references","aria-hidden":"true"}},[t._v("#")]),t._v(" Configuration References")]),t._v(" "),a("p",[a("router-link",{attrs:{to:"/apache_mod_lsapi/#mod-lsapi-customization"}},[t._v("mod_lsapi customization")]),t._v(":")],1),t._v(" "),a("ul",[a("li",[a("router-link",{attrs:{to:"/apache_mod_lsapi/#lsapi-engine"}},[t._v("lsapi_engine")])],1),t._v(" "),a("li",[a("router-link",{attrs:{to:"/apache_mod_lsapi/#lsapi-socket-path"}},[t._v("lsapi_socket_path")])],1),t._v(" "),a("li",[a("router-link",{attrs:{to:"/apache_mod_lsapi/#lsapi-poll-timeout"}},[t._v("lsapi_poll_timeout")])],1),t._v(" "),a("li",[a("router-link",{attrs:{to:"/apache_mod_lsapi/#lsapi-per-user"}},[t._v("lsapi_per_user")])],1),t._v(" "),a("li",[a("router-link",{attrs:{to:"/apache_mod_lsapi/#lsapi-output-buffering"}},[t._v("lsapi_output_buffering")])],1),t._v(" "),a("li",[a("router-link",{attrs:{to:"/apache_mod_lsapi/#lsapi-disable-reject-mode"}},[t._v("lsapi_disable_reject_mode")])],1),t._v(" "),a("li",[a("router-link",{attrs:{to:"/apache_mod_lsapi/#lsapi-terminate-backends-on-exit"}},[t._v("lsapi_terminate_backends_on_exit")])],1),t._v(" "),a("li",[a("router-link",{attrs:{to:"/apache_mod_lsapi/#lsapi-avoid-zombies"}},[t._v("lsapi_avoid_zombies")])],1),t._v(" "),a("li",[a("router-link",{attrs:{to:"/apache_mod_lsapi/#lsapi-use-req-hostname"}},[t._v("lsapi_use_req_hostname")])],1),t._v(" "),a("li",[a("router-link",{attrs:{to:"/apache_mod_lsapi/#lsapi-debug"}},[t._v("lsapi_debug")])],1)]),t._v(" "),a("p",[a("router-link",{attrs:{to:"/apache_mod_lsapi/#tuning-lsphp-backend"}},[t._v("Tuning LSPHP backend")]),t._v(":")],1),t._v(" "),a("ul",[a("li",[a("router-link",{attrs:{to:"/apache_mod_lsapi/#lsapi-set-env"}},[t._v("lsapi_set_env")])],1),t._v(" "),a("li",[a("router-link",{attrs:{to:"/apache_mod_lsapi/#lsapi-set-env-path"}},[t._v("lsapi_set_env_path")])],1),t._v(" "),a("li",[a("router-link",{attrs:{to:"/apache_mod_lsapi/#lsapi-backend-children"}},[t._v("lsapi_backend_children")])],1),t._v(" "),a("li",[a("router-link",{attrs:{to:"/apache_mod_lsapi/#lsapi-backend-connect-tries"}},[t._v("lsapi_backend_connect_tries")])],1),t._v(" "),a("li",[a("router-link",{attrs:{to:"/apache_mod_lsapi/#lsapi-backend-connect-timeout"}},[t._v("lsapi_backend_connect_timeout")])],1),t._v(" "),a("li",[a("router-link",{attrs:{to:"/apache_mod_lsapi/#lsapi-backend-max-process-time"}},[t._v("lsapi_backend_max_process_time")])],1),t._v(" "),a("li",[a("router-link",{attrs:{to:"/apache_mod_lsapi/#lsapi-backend-pgrp-max-idle"}},[t._v("lsapi_backend_pgrp_max_idle")])],1),t._v(" "),a("li",[a("router-link",{attrs:{to:"/apache_mod_lsapi/#lsapi-backend-use-own-log"}},[t._v("lsapi_backend_use_own_log")])],1),t._v(" "),a("li",[a("router-link",{attrs:{to:"/apache_mod_lsapi/#lsapi-backend-common-own-log"}},[t._v("lsapi_backend_common_own_log")])],1),t._v(" "),a("li",[a("router-link",{attrs:{to:"/apache_mod_lsapi/#lsapi-backend-coredump"}},[t._v("lsapi_backend_coredump")])],1),t._v(" "),a("li",[a("router-link",{attrs:{to:"/apache_mod_lsapi/#lsapi-backend-accept-notify"}},[t._v("lsapi_backend_accept_notify")])],1)]),t._v(" "),a("p",[a("router-link",{attrs:{to:"/apache_mod_lsapi/#connection-pool-mode"}},[t._v("Connection pool mode")]),t._v(":")],1),t._v(" "),a("ul",[a("li",[a("router-link",{attrs:{to:"/apache_mod_lsapi/#lsapi-with-connection-pool"}},[t._v("lsapi_with_connection_pool")])],1),t._v(" "),a("li",[a("router-link",{attrs:{to:"/apache_mod_lsapi/#lsapi-backend-max-idle"}},[t._v("lsapi_backend_max_idle")])],1),t._v(" "),a("li",[a("router-link",{attrs:{to:"/apache_mod_lsapi/#lsapi-backend-max-reqs"}},[t._v("lsapi_backend_max_reqs")])],1)]),t._v(" "),a("p",[a("router-link",{attrs:{to:"/apache_mod_lsapi/#criu-support-cloudlinux7-only"}},[t._v("CRIU support (CloudLinux 7 only)")]),t._v(":")],1),t._v(" "),a("ul",[a("li",[a("router-link",{attrs:{to:"/apache_mod_lsapi/#lsapi-criu"}},[t._v("lsapi_criu")])],1),t._v(" "),a("li",[a("router-link",{attrs:{to:"/apache_mod_lsapi/#lsapi-criu-socket-path"}},[t._v("lsapi_criu_socket_path")])],1),t._v(" "),a("li",[a("router-link",{attrs:{to:"/apache_mod_lsapi/#lsapi-criu-imgs-dir-path"}},[t._v("lsapi_criu_imgs_dir_path")])],1),t._v(" "),a("li",[a("router-link",{attrs:{to:"/apache_mod_lsapi/#lsapi-backend-initial-start"}},[t._v("lsapi_backend_initial_start")])],1),t._v(" "),a("li",[a("router-link",{attrs:{to:"/apache_mod_lsapi/#lsapi-criu-use-shm"}},[t._v("lsapi_criu_use_shm")])],1),t._v(" "),a("li",[a("router-link",{attrs:{to:"/apache_mod_lsapi/#lsapi-backend-semtimedwait"}},[t._v("lsapi_backend_semtimedwait")])],1),t._v(" "),a("li",[a("router-link",{attrs:{to:"/apache_mod_lsapi/#lsapi-reset-criu-on-apache-restart"}},[t._v("lsapi_reset_criu_on_apache_restart")])],1)]),t._v(" "),a("p",[a("router-link",{attrs:{to:"/apache_mod_lsapi/#php-configuration-management"}},[t._v("PHP configuration management")]),t._v(":")],1),t._v(" "),a("ul",[a("li",[a("router-link",{attrs:{to:"/apache_mod_lsapi/#lsapi-process-phpini"}},[t._v("lsapi_process_phpini")])],1),t._v(" "),a("li",[a("router-link",{attrs:{to:"/apache_mod_lsapi/#lsapi-phpini"}},[t._v("lsapi_phpini")])],1),t._v(" "),a("li",[a("router-link",{attrs:{to:"/apache_mod_lsapi/#lsapi-phprc"}},[t._v("lsapi_phprc")])],1),t._v(" "),a("li",[a("router-link",{attrs:{to:"/apache_mod_lsapi/#lsapi-tmpdir"}},[t._v("lsapi_tmpdir")])],1),t._v(" "),a("li",[a("router-link",{attrs:{to:"/apache_mod_lsapi/#lsapi-enable-user-ini"}},[t._v("lsapi_enable_user_ini")])],1),t._v(" "),a("li",[a("router-link",{attrs:{to:"/apache_mod_lsapi/#lsapi-user-ini-homedir"}},[t._v("lsapi_user_ini_homedir")])],1),t._v(" "),a("li",[a("router-link",{attrs:{to:"/apache_mod_lsapi/#lsapi-keep-http200"}},[t._v("lsapi_keep_http200")])],1),t._v(" "),a("li",[a("router-link",{attrs:{to:"/apache_mod_lsapi/#lsapi-mod-php-behaviour"}},[t._v("lsapi_mod_php_behaviour")])],1),t._v(" "),a("li",[a("router-link",{attrs:{to:"/apache_mod_lsapi/#php-valuephp-admin-valuephp-flagphp-admin-flag"}},[t._v("php_value, php_admin_value, php_flag, php_admin_flag")])],1)]),t._v(" "),a("p",[a("router-link",{attrs:{to:"/apache_mod_lsapi/#security"}},[t._v("Security")]),t._v(":")],1),t._v(" "),a("ul",[a("li",[a("router-link",{attrs:{to:"/apache_mod_lsapi/#lsapi-use-suexec"}},[t._v("lsapi_use_suexec")])],1),t._v(" "),a("li",[a("router-link",{attrs:{to:"/apache_mod_lsapi/#lsapi-user-group"}},[t._v("lsapi_user_group")])],1),t._v(" "),a("li",[a("router-link",{attrs:{to:"/apache_mod_lsapi/#lsapi-uid-gid"}},[t._v("lsapi_uid_gid")])],1),t._v(" "),a("li",[a("router-link",{attrs:{to:"/apache_mod_lsapi/#lsapi-use-default-uid"}},[t._v("lsapi_use_default_uid")])],1),t._v(" "),a("li",[a("router-link",{attrs:{to:"/apache_mod_lsapi/#lsapi-target-perm"}},[t._v("lsapi_target_perm")])],1),t._v(" "),a("li",[a("router-link",{attrs:{to:"/apache_mod_lsapi/#lsapi-paranoid"}},[t._v("lsapi_paranoid")])],1),t._v(" "),a("li",[a("router-link",{attrs:{to:"/apache_mod_lsapi/#lsapi-check-document-root"}},[t._v("lsapi_check_document_root")])],1),t._v(" "),a("li",[a("router-link",{attrs:{to:"/apache_mod_lsapi/#lsapi-disable-forced-pwd-var"}},[t._v("lsapi_disable_forced_pwd_var")])],1),t._v(" "),a("li",[a("router-link",{attrs:{to:"/apache_mod_lsapi/#lsapi-max-resend-buffer"}},[t._v("lsapi_max_resend_buffer")])],1)]),t._v(" "),a("h4",{attrs:{id:"mod-lsapi-customization"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mod-lsapi-customization","aria-hidden":"true"}},[t._v("#")]),t._v(" "),a("strong",[t._v("mod_lsapi customization")])]),t._v(" "),a("h4",{attrs:{id:"lsapi-engine"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#lsapi-engine","aria-hidden":"true"}},[t._v("#")]),t._v(" "),a("strong",[t._v("lsapi_engine")])]),t._v(" "),a("p",[a("strong",[t._v("Syntax")]),t._v(" : lsapi_engine on/off"),a("br"),t._v(" "),a("strong",[t._v("Default")]),t._v(" : lsapi_engine off"),a("br"),t._v(" "),a("strong",[t._v("Context")]),t._v(" : httpd.conf, htaccess")]),t._v(" "),a("p",[a("strong",[t._v("Description")]),t._v(" :"),a("br"),t._v("\nSwitching mod_lsapi handler on or off.")]),t._v(" "),a("hr"),t._v(" "),a("h4",{attrs:{id:"lsapi-socket-path"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#lsapi-socket-path","aria-hidden":"true"}},[t._v("#")]),t._v(" "),a("strong",[t._v("lsapi_socket_path")])]),t._v(" "),a("p",[a("strong",[t._v("Syntax")]),t._v(" : lsapi_socket_path [path]\n"),a("strong",[t._v("Default")]),t._v(" : lsapi_socket_path "),a("code",[t._v("/var/run/mod_lsapi")]),a("br"),t._v(" "),a("strong",[t._v("Context")]),t._v(" : httpd.conf")]),t._v(" "),a("p",[a("strong",[t._v("Description:")]),a("br"),t._v("\nPath to backend lsphp sockets. By default "),a("code",[t._v("/var/run/mod_lsapi")])]),t._v(" "),a("hr"),t._v(" "),a("h4",{attrs:{id:"lsapi-poll-timeout"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#lsapi-poll-timeout","aria-hidden":"true"}},[t._v("#")]),t._v(" "),a("strong",[t._v("lsapi_poll_timeout")])]),t._v(" "),a("p",[a("strong",[t._v("Syntax")]),t._v(" : lsapi_poll_timeout [number]"),a("br"),t._v(" "),a("strong",[t._v("Default")]),t._v(" : lsapi_poll_timeout 300"),a("br"),t._v(" "),a("strong",[t._v("Context")]),t._v(" : httpd.conf, htaccess")]),t._v(" "),a("p",[a("strong",[t._v("Description")]),t._v(" :"),a("br"),t._v("\nTime to wait for response from the lsphp daemon, in seconds. 0 stands for infinity. For preventing long running processes which can use EP (limit number of entry processes). Default value is 300. Should be more or equal to 0. In the case of wrong format, the default value will be used.")]),t._v(" "),a("hr"),t._v(" "),a("h4",{attrs:{id:"lsapi-per-user"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#lsapi-per-user","aria-hidden":"true"}},[t._v("#")]),t._v(" "),a("strong",[t._v("lsapi_per_user")])]),t._v(" "),a("p",[a("strong",[t._v("Syntax")]),t._v(" : lsapi_per_user On/Off"),a("br"),t._v(" "),a("strong",[t._v("Default")]),t._v(" : lsapi_per_user Off"),a("br"),t._v(" "),a("strong",[t._v("Context")]),t._v(" : httpd.conf")]),t._v(" "),a("p",[a("strong",[t._v("Description")]),t._v(" :"),a("br"),t._v("\nInvoke master lsPHP process not per VirtualHost but per account.\nWhen On, invoke backend not per VirtualHost but per account.\nDefault value is Off.\nIt is possible, for example, to set it to On in global config file and to Off in config files of some particular Virtual Hosts.\nThen these Virtual Hosts will have a dedicated backend process, while others will have backend processes shared on account basis.")]),t._v(" "),a("hr"),t._v(" "),a("h4",{attrs:{id:"lsapi-output-buffering"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#lsapi-output-buffering","aria-hidden":"true"}},[t._v("#")]),t._v(" "),a("strong",[t._v("lsapi_output_buffering")])]),t._v(" "),a("p",[a("strong",[t._v("Syntax")]),t._v(" : lsapi_output_buffering On/Off"),a("br"),t._v(" "),a("strong",[t._v("Default")]),t._v(" : lsapi_output_buffering On"),a("br"),t._v(" "),a("strong",[t._v("Context")]),t._v(" : httpd.conf, virtualhost, htaccess")]),t._v(" "),a("p",[a("strong",[t._v("Description")]),t._v(" :"),a("br"),t._v("\nEnable or disable output buffering on Apache level. Default value is On.")]),t._v(" "),a("hr"),t._v(" "),a("h4",{attrs:{id:"lsapi-disable-reject-mode"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#lsapi-disable-reject-mode","aria-hidden":"true"}},[t._v("#")]),t._v(" "),a("strong",[t._v("lsapi_disable_reject_mode")])]),t._v(" "),a("p",[a("strong",[t._v("Syntax")]),t._v(" : lsapi_disable_reject_mode On/Off"),a("br"),t._v(" "),a("strong",[t._v("Default")]),t._v(" : lsapi_disable_reject_mode Off"),a("br"),t._v(" "),a("strong",[t._v("Context")]),t._v(" : httpd.conf, virtualhost")]),t._v(" "),a("p",[a("strong",[t._v("Description")]),t._v(" :"),a("br"),t._v("\nIf a new HTTP request is coming to LSPHP daemon when all LSPHP workers are still busy, it can process this situation in two different ways. In REJECT mode LSPHP daemon will reject such request immediately. Otherwise, in legacy mode, LSPHP daemon will put this request into infinite queue, until one or more LSPHP daemon becomes free. When HTTP request is rejected in REJECT mode, mod_lsapi will write into Apache error_log the following message: Connect to backend rejected, and the client will receive 507 HTTP response.\nBy default LSPHP daemon in CloudLinux uses REJECT mode. It can be switched off with this option.")]),t._v(" "),a("hr"),t._v(" "),a("h4",{attrs:{id:"lsapi-terminate-backends-on-exit"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#lsapi-terminate-backends-on-exit","aria-hidden":"true"}},[t._v("#")]),t._v(" "),a("strong",[t._v("lsapi_terminate_backends_on_exit")])]),t._v(" "),a("p",[a("strong",[t._v("Syntax")]),t._v(" : lsapi_terminate_backends_on_exit On/Off"),a("br"),t._v(" "),a("strong",[t._v("Default")]),t._v(" : lsapi_terminate_backends_on_exit On"),a("br"),t._v(" "),a("strong",[t._v("Context")]),t._v(" : httpd.conf")]),t._v(" "),a("p",[a("strong",[t._v("Description")]),t._v(" :"),a("br"),t._v("\nhttpd.conf, On - stop lsphp services on apache restart, Off - leave live started lsphp services on apache restart (for php+opcache). The lsphp will not restart, even if Apache gets restarted.")]),t._v(" "),a("hr"),t._v(" "),a("h4",{attrs:{id:"lsapi-avoid-zombies"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#lsapi-avoid-zombies","aria-hidden":"true"}},[t._v("#")]),t._v(" "),a("strong",[t._v("lsapi_avoid_zombies")])]),t._v(" "),a("p",[a("strong",[t._v("Syntax")]),t._v(" : lsapi_avoid_zombies On/Off"),a("br"),t._v(" "),a("strong",[t._v("Default")]),t._v(" : lsapi_avoid_zombies Off"),a("br"),t._v(" "),a("strong",[t._v("Context")]),t._v(" : httpd.conf, virtualhost")]),t._v(" "),a("p",[a("strong",[t._v("Description")]),t._v(" :"),a("br"),t._v("\nEnable or disable a mechanism to avoid creation of zombie processes by lsphp. Default value is Off.")]),t._v(" "),a("hr"),t._v(" "),a("h4",{attrs:{id:"lsapi-use-req-hostname"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#lsapi-use-req-hostname","aria-hidden":"true"}},[t._v("#")]),t._v(" "),a("strong",[t._v("lsapi_use_req_hostname")])]),t._v(" "),a("p",[a("strong",[t._v("Syntax")]),t._v(" : lsapi_use_req_hostname On/Off"),a("br"),t._v(" "),a("strong",[t._v("Default")]),t._v(" : lsapi_use_req_hostname Off"),a("br"),t._v(" "),a("strong",[t._v("Context")]),t._v(" : httpd.conf, virtualhosts")]),t._v(" "),a("p",[a("strong",[t._v("Description")]),t._v(" :"),a("br"),t._v("\nBy default, we are using hostname from the server_rec structure (off), it means that mod_lsapi takes hostname from the VirtualHost section of the configuration file. Using hostname from the request_rec structure (On) means that mod_lsapi takes hostname from the HOST section of the request. It could be useful for those who use dynamically generated configs for virtual hosts for example with mod_lua.")]),t._v(" "),a("hr"),t._v(" "),a("h4",{attrs:{id:"lsapi-sentry"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#lsapi-sentry","aria-hidden":"true"}},[t._v("#")]),t._v(" "),a("strong",[t._v("lsapi_sentry")])]),t._v(" "),a("p",[a("strong",[t._v("Syntax")]),t._v(" : lsapi_sentry On/Off"),a("br"),t._v(" "),a("strong",[t._v("Default")]),t._v(" : lsapi_sentry On"),a("br"),t._v(" "),a("strong",[t._v("Context")]),t._v(" : httpd.conf")]),t._v(" "),a("p",[a("strong",[t._v("Description")]),t._v(" :"),a("br"),t._v("\nWhen this option is enabled, errors that occur in the operation of the mod_lsapi will be sent to the remote sentry server. You can see the error messages that were sent to the sentry server in the directory /var/log/mod_lsapi. If you do not want to send error notifications from your server, you can disable this directive in lsapi.conf.")]),t._v(" "),a("hr"),t._v(" "),a("h4",{attrs:{id:"lsapi-debug"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#lsapi-debug","aria-hidden":"true"}},[t._v("#")]),t._v(" "),a("strong",[t._v("lsapi_debug")])]),t._v(" "),a("p",[a("strong",[t._v("Syntax")]),t._v(" : lsapi_debug On/Off"),a("br"),t._v(" "),a("strong",[t._v("Default")]),t._v(" : lsapi_debug Off"),a("br"),t._v(" "),a("strong",[t._v("Context")]),t._v(" : httpd.conf, virtualhost")]),t._v(" "),a("p",[a("strong",[t._v("Description")]),t._v(" :"),a("br"),t._v("\nExtended debug logging.")]),t._v(" "),a("hr"),t._v(" "),a("h4",{attrs:{id:"tuning-lsphp-backend"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#tuning-lsphp-backend","aria-hidden":"true"}},[t._v("#")]),t._v(" "),a("strong",[t._v("Tuning LSPHP backend")])]),t._v(" "),a("h4",{attrs:{id:"lsapi-set-env"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#lsapi-set-env","aria-hidden":"true"}},[t._v("#")]),t._v(" "),a("strong",[t._v("lsapi_set_env")])]),t._v(" "),a("p",[a("strong",[t._v("Syntax")]),t._v(" : lsapi_set_env VAR_NAME [VAR_VALUE]"),a("br"),t._v(" "),a("strong",[t._v("Default")]),t._v(" : -"),a("br"),t._v(" "),a("strong",[t._v("Context")]),t._v(" : httpd.conf")]),t._v(" "),a("p",[a("strong",[t._v("Description")]),t._v(" :"),a("br"),t._v("\nPass env variable to lsphp. By default lsphp environment have only TEMP, TMP and PATH variables set."),a("br"),t._v('\nExample: lsapi_set_env TMP "/var/lsphp-tmp"'),a("br"),t._v('\nNote: PATH env var default "/usr/local/bin:/usr/bin:/bin" cannot be changed because of security reasons.'),a("br"),t._v("\nTo change it, use explicitly lsapi_set_env_path option.")]),t._v(" "),a("hr"),t._v(" "),a("h4",{attrs:{id:"lsapi-set-env-path"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#lsapi-set-env-path","aria-hidden":"true"}},[t._v("#")]),t._v(" "),a("strong",[t._v("lsapi_set_env_path")])]),t._v(" "),a("p",[a("strong",[t._v("Syntax")]),t._v(" : lsapi_set_env_path [path(s)]"),a("br"),t._v(" "),a("strong",[t._v("Default")]),t._v(" : lsapi_set_env_path /usr/local/bin:/usr/bin:/bin"),a("br"),t._v(" "),a("strong",[t._v("Context")]),t._v(" : httpd.conf")]),t._v(" "),a("p",[a("strong",[t._v("Description")]),t._v(" :"),a("br"),t._v("\nChange PATH variable in the environment of lsPHP processes. Default path /usr/local/bin:/usr/bin:/bin will be used if not set.")]),t._v(" "),a("hr"),t._v(" "),a("h4",{attrs:{id:"lsapi-backend-children"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#lsapi-backend-children","aria-hidden":"true"}},[t._v("#")]),t._v(" "),a("strong",[t._v("lsapi_backend_children")])]),t._v(" "),a("p",[a("strong",[t._v("Syntax")]),t._v(" : lsapi_backend_children [number]"),a("br"),t._v(" "),a("strong",[t._v("Default")]),t._v(" : lsapi_backend_children [EP]"),a("br"),t._v(" "),a("strong",[t._v("Context")]),t._v(" : httpd.conf")]),t._v(" "),a("p",[a("strong",[t._v("Description")]),t._v(" :"),a("br"),t._v("\nSets env variable LSAPI_CHILDREN"),a("br"),t._v("\nMaximum number of simultaneously running child backend processes."),a("br"),t._v("\nOptional, a default value is equal to EP."),a("br"),t._v("\nmin value is 2; max value is 10000. If var value is more, 10000 will be used.")]),t._v(" "),a("hr"),t._v(" "),a("h4",{attrs:{id:"lsapi-backend-connect-tries"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#lsapi-backend-connect-tries","aria-hidden":"true"}},[t._v("#")]),t._v(" "),a("strong",[t._v("lsapi_backend_connect_tries")])]),t._v(" "),a("p",[a("strong",[t._v("Syntax")]),t._v(" : lsapi_backend_connect_tries [number]"),a("br"),t._v(" "),a("strong",[t._v("Default")]),t._v(" : lsapi_backend_connect_tries 20"),a("br"),t._v(" "),a("strong",[t._v("Context")]),t._v(" : httpd.conf")]),t._v(" "),a("p",[a("strong",[t._v("Description")]),t._v(" :"),a("br"),t._v("\nNumber of retries to connects to lsPHP daemon.")]),t._v(" "),a("hr"),t._v(" "),a("h4",{attrs:{id:"lsapi-backend-connect-timeout"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#lsapi-backend-connect-timeout","aria-hidden":"true"}},[t._v("#")]),t._v(" "),a("strong",[t._v("lsapi_backend_connect_timeout")])]),t._v(" "),a("p",[a("strong",[t._v("Syntax")]),t._v(" : lsapi_backend_connect_timeout [number]"),a("br"),t._v(" "),a("strong",[t._v("Default")]),t._v(" : lsapi_backend_connect_timeout 500000"),a("br"),t._v(" "),a("strong",[t._v("Context")]),t._v(" : httpd.conf")]),t._v(" "),a("p",[a("strong",[t._v("Description")]),t._v(" :"),a("br"),t._v("\nNumber of usec to wait while lsPHP starts (if not started on request).")]),t._v(" "),a("hr"),t._v(" "),a("h4",{attrs:{id:"lsapi-backend-max-process-time"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#lsapi-backend-max-process-time","aria-hidden":"true"}},[t._v("#")]),t._v(" "),a("strong",[t._v("lsapi_backend_max_process_time")])]),t._v(" "),a("p",[a("strong",[t._v("Syntax")]),t._v(" : lsapi_backend_max_process_time [number]"),a("br"),t._v(" "),a("strong",[t._v("Default")]),t._v(" : lsapi_backend_max_process_time 300"),a("br"),t._v(" "),a("strong",[t._v("Context")]),t._v(" : httpd.conf")]),t._v(" "),a("p",[a("strong",[t._v("Description")]),t._v(" :"),a("br"),t._v("\nSets env variable LSAPI_MAX_PROCESS_TIME"),a("br"),t._v("\nOptional. Default value is 300."),a("br"),t._v("\nTimeout to kill runaway processes.")]),t._v(" "),a("hr"),t._v(" "),a("h4",{attrs:{id:"lsapi-backend-pgrp-max-idle"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#lsapi-backend-pgrp-max-idle","aria-hidden":"true"}},[t._v("#")]),t._v(" "),a("strong",[t._v("lsapi_backend_pgrp_max_idle")])]),t._v(" "),a("p",[a("strong",[t._v("Syntax")]),t._v(" : lsapi_backend_pgrp_max_idle [number]"),a("br"),t._v(" "),a("strong",[t._v("Default")]),t._v(" : lsapi_backend_pgrp_max_idle 30"),a("br"),t._v(" "),a("strong",[t._v("Context")]),t._v(" : httpd.conf")]),t._v(" "),a("p",[a("strong",[t._v("Description")]),t._v(" :"),a("br"),t._v("\nSets env variable LSAPI_PGRP_MAX_IDLE, in seconds."),a("br"),t._v("\nControls how long a control process will wait for a new request before it exits. # 0 stands for infinite."),a("br"),t._v("\nOptional, default value is 30."),a("br"),t._v("\nShould be more or equal to 0.")]),t._v(" "),a("hr"),t._v(" "),a("h4",{attrs:{id:"lsapi-backend-use-own-log"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#lsapi-backend-use-own-log","aria-hidden":"true"}},[t._v("#")]),t._v(" "),a("strong",[t._v("lsapi_backend_use_own_log")])]),t._v(" "),a("p",[a("strong",[t._v("Syntax")]),t._v(" : lsapi_backend_use_own_log On/Off"),a("br"),t._v(" "),a("strong",[t._v("Default")]),t._v(" : lsapi_backend_use_own_log Off"),a("br"),t._v(" "),a("strong",[t._v("Context")]),t._v(" : httpd.conf, virtualhost, htaccess")]),t._v(" "),a("p",[a("strong",[t._v("Description")]),t._v(" :"),a("br"),t._v("\nRedirecting log output of backend processes from Apache error_log to dedicated log file or files, depending on value of lsapi_backend_common_own_log option. If Off, use Apache error log file for backend output, or separate file otherwise.")]),t._v(" "),a("hr"),t._v(" "),a("h4",{attrs:{id:"lsapi-backend-common-own-log"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#lsapi-backend-common-own-log","aria-hidden":"true"}},[t._v("#")]),t._v(" "),a("strong",[t._v("lsapi_backend_common_own_log")])]),t._v(" "),a("p",[a("strong",[t._v("Syntax")]),t._v(" : lsapi_backend_common_own_log On/Off"),a("br"),t._v(" "),a("strong",[t._v("Default")]),t._v(" : lsapi_backend_common_own_log Off"),a("br"),t._v(" "),a("strong",[t._v("Context")]),t._v(" : httpd.conf, virtualhost, htaccess")]),t._v(" "),a("p",[a("strong",[t._v("Description")]),t._v(" :"),a("br"),t._v("\nIt will be used only when lsapi_backend_use_own_log set to On. On - backend processes of the all virtual hosts will share the common log file. Off - every virtual host will have its own backend log file.")]),t._v(" "),a("hr"),t._v(" "),a("h4",{attrs:{id:"lsapi-backend-coredump"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#lsapi-backend-coredump","aria-hidden":"true"}},[t._v("#")]),t._v(" "),a("strong",[t._v("lsapi_backend_coredump")])]),t._v(" "),a("p",[a("strong",[t._v("Syntax")]),t._v(" : lsapi_backend_coredump On/Off"),a("br"),t._v(" "),a("strong",[t._v("Default")]),t._v(" : lsapi_backend_coredump Off"),a("br"),t._v(" "),a("strong",[t._v("Context")]),t._v(" : httpd.conf, htaccess")]),t._v(" "),a("p",[a("strong",[t._v("Description")]),t._v(" :"),a("br"),t._v("\nenv variable LSAPI_ALLOW_CORE_DUMP (On or Off). Pass LSAPI_ALLOW_CORE_DUMP to lsphp or not. If it will be passed - core dump on lsphp crash will be created."),a("br"),t._v("\nOff by default."),a("br"),t._v("\nBy default LSAPI application will not leave a core dump file when crashed. If you want to have LSAPI PHP dump a core file, you should set this environment variable. If set, regardless the value has been set to, core files will be created under the directory that the PHP script in.")]),t._v(" "),a("hr"),t._v(" "),a("h4",{attrs:{id:"lsapi-backend-accept-notify"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#lsapi-backend-accept-notify","aria-hidden":"true"}},[t._v("#")]),t._v(" "),a("strong",[t._v("lsapi_backend_accept_notify")])]),t._v(" "),a("p",[a("strong",[t._v("Syntax")]),t._v(" : lsapi_backend_accept_notify On/Off"),a("br"),t._v(" "),a("strong",[t._v("Default")]),t._v(" : lsapi_backend_accept_notify On"),a("br"),t._v(" "),a("strong",[t._v("Context")]),t._v(" : httpd.conf, virtualhost")]),t._v(" "),a("p",[a("strong",[t._v("Description")]),t._v(" :"),a("br"),t._v("\nSwitch LSAPI_ACCEPT_NOTIFY mode for lsphp. This option can be used both in Global and VirtualHost scopes.This mode is incompatible with PHP 4.4.")]),t._v(" "),a("hr"),t._v(" "),a("h4",{attrs:{id:"connection-pool-mode"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#connection-pool-mode","aria-hidden":"true"}},[t._v("#")]),t._v(" "),a("strong",[t._v("Connection pool mode")])]),t._v(" "),a("h4",{attrs:{id:"lsapi-with-connection-pool"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#lsapi-with-connection-pool","aria-hidden":"true"}},[t._v("#")]),t._v(" "),a("strong",[t._v("lsapi_with_connection_pool")])]),t._v(" "),a("p",[a("strong",[t._v("Syntax")]),t._v(" : lsapi_with_connection_pool On/Off"),a("br"),t._v(" "),a("strong",[t._v("Default")]),t._v(" : lsapi_with_connection_pool Off"),a("br"),t._v(" "),a("strong",[t._v("Context")]),t._v(" : httpd.conf")]),t._v(" "),a("p",[a("strong",[t._v("Description")]),t._v(" :"),a("br"),t._v("\nOn/Off - disable enable connect pool, default is Off.")]),t._v(" "),a("hr"),t._v(" "),a("h4",{attrs:{id:"lsapi-backend-max-idle"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#lsapi-backend-max-idle","aria-hidden":"true"}},[t._v("#")]),t._v(" "),a("strong",[t._v("lsapi_backend_max_idle")])]),t._v(" "),a("p",[a("strong",[t._v("Syntax")]),t._v(" : lsapi_backend_max_idle [number]"),a("br"),t._v(" "),a("strong",[t._v("Default")]),t._v(" : lsapi_backend_max_idle 300"),a("br"),t._v(" "),a("strong",[t._v("Context")]),t._v(" : httpd.conf")]),t._v(" "),a("p",[a("strong",[t._v("Description")]),t._v(" :"),a("br"),t._v("\nIt is relevant only with lsapi_with_connection_pool option switched on. Controls how long a worker process will wait for a new request before it exits. 0 stands for infinite. Should be more or equal to 0. In the case of wrong format default value will be used. Optional, default value is 300.")]),t._v(" "),a("hr"),t._v(" "),a("h4",{attrs:{id:"lsapi-backend-max-reqs"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#lsapi-backend-max-reqs","aria-hidden":"true"}},[t._v("#")]),t._v(" "),a("strong",[t._v("lsapi_backend_max_reqs")])]),t._v(" "),a("p",[a("strong",[t._v("Syntax")]),t._v(" : lsapi_backend_max_reqs [number]"),a("br"),t._v(" "),a("strong",[t._v("Default")]),t._v(" : lsapi_backend_max_reqs 10000"),a("br"),t._v(" "),a("strong",[t._v("Context")]),t._v(" : httpd.conf")]),t._v(" "),a("p",[a("strong",[t._v("Description")]),t._v(" :"),a("br"),t._v("\nIt is relevant only with lsapi_with_connection_pool option switched on. Controls how many requests a worker process will process before it exits. Should be more than 0. In the case of wrong format default value will be used. Optional, default value is 10000.")]),t._v(" "),a("hr"),t._v(" "),a("h4",{attrs:{id:"criu-support-cloudlinux-7-only"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#criu-support-cloudlinux-7-only","aria-hidden":"true"}},[t._v("#")]),t._v(" "),a("strong",[t._v("CRIU support (CloudLinux 7 only)")])]),t._v(" "),a("h4",{attrs:{id:"lsapi-criu"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#lsapi-criu","aria-hidden":"true"}},[t._v("#")]),t._v(" "),a("strong",[t._v("lsapi_criu")])]),t._v(" "),a("p",[a("strong",[t._v("Syntax")]),t._v(" : lsapi_criu On/Off"),a("br"),t._v(" "),a("strong",[t._v("Default")]),t._v(" : lsapi_criu Off"),a("br"),t._v(" "),a("strong",[t._v("Context")]),t._v(" : httpd.conf")]),t._v(" "),a("p",[a("strong",[t._v("Description")]),t._v(" :"),a("br"),t._v("\nEnable/disable CRIU for lsphp freezing. Default: Off.")]),t._v(" "),a("hr"),t._v(" "),a("h4",{attrs:{id:"lsapi-criu-socket-path"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#lsapi-criu-socket-path","aria-hidden":"true"}},[t._v("#")]),t._v(" "),a("strong",[t._v("lsapi_criu_socket_path")])]),t._v(" "),a("p",[a("strong",[t._v("Syntax")]),t._v(" : lsapi_criu_socket_path [path]"),a("br"),t._v(" "),a("strong",[t._v("Default")]),t._v(" : lsapi_criu_socket_path /var/run/criu/criu_service.socket"),a("br"),t._v(" "),a("strong",[t._v("Context")]),t._v(" : httpd.conf")]),t._v(" "),a("p",[a("strong",[t._v("Description")]),t._v(" :"),a("br"),t._v("\nSet path to socket for communication with criu service. Default: /var/run/criu/criu_service.socket.")]),t._v(" "),a("hr"),t._v(" "),a("h4",{attrs:{id:"lsapi-criu-imgs-dir-path"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#lsapi-criu-imgs-dir-path","aria-hidden":"true"}},[t._v("#")]),t._v(" "),a("strong",[t._v("lsapi_criu_imgs_dir_path")])]),t._v(" "),a("p",[a("strong",[t._v("Syntax")]),t._v(" : lsapi_criu_imgs_dir_path [path]"),a("br"),t._v(" "),a("strong",[t._v("Default")]),t._v(" : lsapi_criu_imgs_dir_path /var/run/mod_lsapi/"),a("br"),t._v(" "),a("strong",[t._v("Context")]),t._v(" : httpd.conf")]),t._v(" "),a("p",[a("strong",[t._v("Description")]),t._v(" :"),a("br"),t._v("\nPath to folder where images of freezed PHP will be stored. Should be path. Default: /var/run/mod_lsapi/")]),t._v(" "),a("hr"),t._v(" "),a("h4",{attrs:{id:"lsapi-backend-initial-start"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#lsapi-backend-initial-start","aria-hidden":"true"}},[t._v("#")]),t._v(" "),a("strong",[t._v("lsapi_backend_initial_start")])]),t._v(" "),a("p",[a("strong",[t._v("Syntax")]),t._v(" : lsapi_backend_initial_start [number]"),a("br"),t._v(" "),a("strong",[t._v("Default")]),t._v(" : lsapi_backend_initial_start 0"),a("br"),t._v(" "),a("strong",[t._v("Context")]),t._v(" : httpd.conf")]),t._v(" "),a("p",[a("strong",[t._v("Description")]),t._v(" :"),a("br"),t._v("\nNumber of requests to virtualhost, when lsphp will be freezed.  Default: 0 - means disable freezing.")]),t._v(" "),a("hr"),t._v(" "),a("h4",{attrs:{id:"lsapi-criu-use-shm"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#lsapi-criu-use-shm","aria-hidden":"true"}},[t._v("#")]),t._v(" "),a("strong",[t._v("lsapi_criu_use_shm")])]),t._v(" "),a("p",[a("strong",[t._v("Syntax")]),t._v(" : lsapi_criu_use_shm Off/Signals"),a("br"),t._v(" "),a("strong",[t._v("Default")]),t._v(" : lsapi_criu_use_shm Off"),a("br"),t._v(" "),a("strong",[t._v("Context")]),t._v(" : httpd.conf")]),t._v(" "),a("p",[a("strong",[t._v("Description")]),t._v(" :"),a("br"),t._v("\nMethod of requests counting. Off - use shared memory. Signals - use signals from child processes to parent. Default: Off")]),t._v(" "),a("hr"),t._v(" "),a("h4",{attrs:{id:"lsapi-backend-semtimedwait"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#lsapi-backend-semtimedwait","aria-hidden":"true"}},[t._v("#")]),t._v(" "),a("strong",[t._v("lsapi_backend_semtimedwait")])]),t._v(" "),a("p",[a("strong",[t._v("Syntax")]),t._v(" : lsapi_backend_semtimedwait On/Off"),a("br"),t._v(" "),a("strong",[t._v("Default")]),t._v(" : lsapi_backend_semtimedwait On"),a("br"),t._v(" "),a("strong",[t._v("Context")]),t._v(" : httpd.conf")]),t._v(" "),a("p",[a("strong",[t._v("Description")]),t._v(" :"),a("br"),t._v("\nUse semaphore for checking when lsphp process will be started. Speed of start lsphp increased with semaphore using. This method avoid cycles of waiting for lsphp start. Default: On.")]),t._v(" "),a("hr"),t._v(" "),a("h4",{attrs:{id:"lsapi-reset-criu-on-apache-restart"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#lsapi-reset-criu-on-apache-restart","aria-hidden":"true"}},[t._v("#")]),t._v(" "),a("strong",[t._v("lsapi_reset_criu_on_apache_restart")])]),t._v(" "),a("p",[a("strong",[t._v("Syntax")]),t._v(" : lsapi_reset_criu_on_apache_restart On/Off"),a("br"),t._v(" "),a("strong",[t._v("Default")]),t._v(" : lsapi_reset_criu_on_apache_restart Off"),a("br"),t._v(" "),a("strong",[t._v("Context")]),t._v(" : httpd.conf, virtualhost")]),t._v(" "),a("p",[a("strong",[t._v("Description")]),t._v(" :"),a("br"),t._v("\nThis option allows cleaning all CRIU images on Apache restart."),a("br"),t._v("\nSetting lsapi_reset_criu_on_apache_restart to On means that on each Apache restart the CRIU images which are stored in directory specified by lsapi_criu_imgs_dir_path directive will be recreated on new request to domain(only after restart)."),a("br"),t._v("\nIf this option set to Off then CRIU images won’t be recreated on Apache restart.")]),t._v(" "),a("hr"),t._v(" "),a("h4",{attrs:{id:"php-configuration-management"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#php-configuration-management","aria-hidden":"true"}},[t._v("#")]),t._v(" "),a("strong",[t._v("PHP configuration management")])]),t._v(" "),a("h4",{attrs:{id:"lsapi-process-phpini"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#lsapi-process-phpini","aria-hidden":"true"}},[t._v("#")]),t._v(" "),a("strong",[t._v("lsapi_process_phpini")])]),t._v(" "),a("p",[a("strong",[t._v("Syntax")]),t._v(" : lsapi_process_phpini On/Off"),a("br"),t._v(" "),a("strong",[t._v("Default")]),t._v(" : lsapi_process_phpini Off"),a("br"),t._v(" "),a("strong",[t._v("Context")]),t._v(" : httpd.conf, virtualhost, directory")]),t._v(" "),a("p",[a("strong",[t._v("Description")]),t._v(" :"),a("br"),t._v("\nEnable or disable phpini_* directive processing. Default value is Off.")]),t._v(" "),a("hr"),t._v(" "),a("h4",{attrs:{id:"lsapi-phpini"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#lsapi-phpini","aria-hidden":"true"}},[t._v("#")]),t._v(" "),a("strong",[t._v("lsapi_phpini")])]),t._v(" "),a("p",[a("strong",[t._v("Syntax")]),t._v(" : lsapi_phpini [path]"),a("br"),t._v(" "),a("strong",[t._v("Default")]),t._v(" : lsapi_phpini -"),a("br"),t._v(" "),a("strong",[t._v("Context")]),t._v(" : httpd.conf, virtualhost, htaccess")]),t._v(" "),a("p",[a("strong",[t._v("Description")]),t._v(" :"),a("br"),t._v("\nWhen lsapi_process_phpini option switched to Off, these values will be silently ignored. lsapi_phpini values with absolute filename of php.ini file can be inserted into .htaccess files in order to set custom php.ini which will override/complement settings from system default php.ini.")]),t._v(" "),a("hr"),t._v(" "),a("h4",{attrs:{id:"lsapi-phprc"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#lsapi-phprc","aria-hidden":"true"}},[t._v("#")]),t._v(" "),a("strong",[t._v("lsapi_phprc")])]),t._v(" "),a("p",[a("strong",[t._v("Syntax")]),t._v(" : lsapi_phprc [No | Env | Auto | DocRoot]"),a("br"),t._v(" "),a("strong",[t._v("Default")]),t._v(" : lsapi_phprc No"),a("br"),t._v(" "),a("strong",[t._v("Context")]),t._v(" : httpd.conf, virtualhost")]),t._v(" "),a("p",[a("strong",[t._v("Description")]),t._v(" :\nThe value of PHPRC env variable."),a("br"),t._v('\nSpecial values are "No", "Env", "Auto" and "DocRoot".'),a("br"),t._v('\nDefault value is "No" - without PHPRC at all.'),a("br"),t._v('\n"Auto" value stands for php.ini from DocumentRoot of the corresponding VirtualHost if it is present, or from user\'s home directory otherwise "DocRoot" value stands for php.ini from DocumentRoot of the corresponding VirtualHost.'),a("br"),t._v('\n"Env" value for using PHPRC from the environment, to set it with SetEnv config option, for example'),a("br"),t._v("\nlsapi_phprc No"),a("br"),t._v("\nlsapi_phprc Auto"),a("br"),t._v("\nlsapi_phprc DocRoot"),a("br"),t._v("\nlsapi_phprc Env"),a("br"),t._v("\nlsapi_phprc /etc/")]),t._v(" "),a("hr"),t._v(" "),a("h4",{attrs:{id:"lsapi-tmpdir"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#lsapi-tmpdir","aria-hidden":"true"}},[t._v("#")]),t._v(" "),a("strong",[t._v("lsapi_tmpdir")])]),t._v(" "),a("p",[a("strong",[t._v("Syntax")]),t._v(" : lsapi_tmpdir [path]"),a("br"),t._v(" "),a("strong",[t._v("Default")]),t._v(" : lsapi_tmpdir /tmp"),a("br"),t._v(" "),a("strong",[t._v("Context")]),t._v(" : httpd.conf, virtualhost")]),t._v(" "),a("p",[a("strong",[t._v("Description")]),t._v(" :"),a("br"),t._v("\nSet alternate request body temporary files directory.")]),t._v(" "),a("hr"),t._v(" "),a("h4",{attrs:{id:"lsapi-enable-user-ini"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#lsapi-enable-user-ini","aria-hidden":"true"}},[t._v("#")]),t._v(" "),a("strong",[t._v("lsapi_enable_user_ini")])]),t._v(" "),a("p",[a("strong",[t._v("Syntax")]),t._v(" : lsapi_enable_user_ini On/Off"),a("br"),t._v(" "),a("strong",[t._v("Default")]),t._v(" : lsapi_enable_user_ini Off"),a("br"),t._v(" "),a("strong",[t._v("Context")]),t._v(" : httpd.conf, virtualhost")]),t._v(" "),a("p",[a("strong",[t._v("Description")]),t._v(" :"),a("br"),t._v("\nEnable .user.ini files for backend. Same as suphp, php-fpm and fcgid mechanism of .user.ini. Default value is Off.")]),t._v(" "),a("hr"),t._v(" "),a("h4",{attrs:{id:"lsapi-user-ini-homedir"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#lsapi-user-ini-homedir","aria-hidden":"true"}},[t._v("#")]),t._v(" "),a("strong",[t._v("lsapi_user_ini_homedir")])]),t._v(" "),a("p",[a("strong",[t._v("Syntax")]),t._v(" : lsapi_user_ini_homedir On/Off"),a("br"),t._v(" "),a("strong",[t._v("Default")]),t._v(" : lsapi_user_ini_homedir Off"),a("br"),t._v(" "),a("strong",[t._v("Context")]),t._v(" : httpd.conf, virtualhost")]),t._v(" "),a("p",[a("strong",[t._v("Description")]),t._v(" :"),a("br"),t._v("\nIf lsapi_enable_user_ini option is set to On, then enable/disable processing .user.ini file in home directory also. Default value is Off.")]),t._v(" "),a("hr"),t._v(" "),a("h4",{attrs:{id:"lsapi-keep-http200"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#lsapi-keep-http200","aria-hidden":"true"}},[t._v("#")]),t._v(" "),a("strong",[t._v("lsapi_keep_http200")])]),t._v(" "),a("p",[a("strong",[t._v("Syntax")]),t._v(" : lsapi_keep_http200 On/Off"),a("br"),t._v(" "),a("strong",[t._v("Default")]),t._v(" : lsapi_keep_http200 Off"),a("br"),t._v(" "),a("strong",[t._v("Context")]),t._v(" : httpd.conf, .htaccess")]),t._v(" "),a("p",[a("strong",[t._v("Description")]),t._v(" :"),a("br"),t._v("\nIf set to On, always keep backend's response status as mod_php do. If set to Off, response status can be overridden by Apache as suphp do (in case of call via ErrorDocument directive).")]),t._v(" "),a("hr"),t._v(" "),a("h4",{attrs:{id:"lsapi-mod-php-behaviour"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#lsapi-mod-php-behaviour","aria-hidden":"true"}},[t._v("#")]),t._v(" "),a("strong",[t._v("lsapi_mod_php_behaviour")])]),t._v(" "),a("p",[a("strong",[t._v("Syntax")]),t._v(" : lsapi_mod_php_behaviour On/Off"),a("br"),t._v(" "),a("strong",[t._v("Default")]),t._v(" : lsapi_mod_php_behaviour On"),a("br"),t._v(" "),a("strong",[t._v("Context")]),t._v(" : httpd.conf, virtualhost, directory")]),t._v(" "),a("p",[a("strong",[t._v("Description")]),t._v(" :"),a("br"),t._v("\nOn/Off - disable php_* directives, default On.")]),t._v(" "),a("hr"),t._v(" "),a("h4",{attrs:{id:"php-value-php-admin-value-php-flag-php-admin-flag"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#php-value-php-admin-value-php-flag-php-admin-flag","aria-hidden":"true"}},[t._v("#")]),t._v(" "),a("strong",[t._v("php_value, php_admin_value, php_flag, php_admin_flag")])]),t._v(" "),a("p",[a("strong",[t._v("Syntax")]),t._v(" : [php_value|php_admin_value|php_flag|php_admin_flag]"),a("br"),t._v(" "),a("strong",[t._v("Default")]),t._v(" :"),a("br"),t._v(" "),a("strong",[t._v("Context")]),t._v(" : httpd.conf, virtualhost, htaccess")]),t._v(" "),a("p",[a("strong",[t._v("Description")]),t._v(" :"),a("br"),t._v("\nmod_php emulation.")]),t._v(" "),a("hr"),t._v(" "),a("h4",{attrs:{id:"security"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#security","aria-hidden":"true"}},[t._v("#")]),t._v(" "),a("strong",[t._v("Security")])]),t._v(" "),a("h4",{attrs:{id:"lsapi-use-suexec"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#lsapi-use-suexec","aria-hidden":"true"}},[t._v("#")]),t._v(" "),a("strong",[t._v("lsapi_use_suexec")])]),t._v(" "),a("p",[a("strong",[t._v("Syntax")]),t._v(" : lsapi_use_suexec On/Off"),a("br"),t._v(" "),a("strong",[t._v("Default")]),t._v(" : lsapi_use_suexec On"),a("br"),t._v(" "),a("strong",[t._v("Context")]),t._v(" : httpd.conf")]),t._v(" "),a("p",[a("strong",[t._v("Description")]),t._v(" :"),a("br"),t._v("\nUse or not suexec to a target user.")]),t._v(" "),a("hr"),t._v(" "),a("h4",{attrs:{id:"lsapi-user-group"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#lsapi-user-group","aria-hidden":"true"}},[t._v("#")]),t._v(" "),a("strong",[t._v("lsapi_user_group")])]),t._v(" "),a("p",[a("strong",[t._v("Syntax")]),t._v(" : lsapi_user_group [user_name] [group_name]"),a("br"),t._v(" "),a("strong",[t._v("Default")]),t._v(" : -"),a("br"),t._v(" "),a("strong",[t._v("Context")]),t._v(" : httpd.conf, virtualhost, directory")]),t._v(" "),a("p",[a("strong",[t._v("Description")]),t._v(" :"),a("br"),t._v("\nSet user & group for requests.")]),t._v(" "),a("hr"),t._v(" "),a("h4",{attrs:{id:"lsapi-uid-gid"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#lsapi-uid-gid","aria-hidden":"true"}},[t._v("#")]),t._v(" "),a("strong",[t._v("lsapi_uid_gid")])]),t._v(" "),a("p",[a("strong",[t._v("Syntax")]),t._v(" : lsapi_uid_gid [uid] [gid]"),a("br"),t._v(" "),a("strong",[t._v("Default")]),t._v(" : -"),a("br"),t._v(" "),a("strong",[t._v("Context")]),t._v(" : httpd.conf, virtualhost, directory")]),t._v(" "),a("p",[a("strong",[t._v("Description")]),t._v(" :"),a("br"),t._v("\nSet user & group for request.")]),t._v(" "),a("hr"),t._v(" "),a("h4",{attrs:{id:"lsapi-use-default-uid"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#lsapi-use-default-uid","aria-hidden":"true"}},[t._v("#")]),t._v(" "),a("strong",[t._v("lsapi_use_default_uid")])]),t._v(" "),a("p",[a("strong",[t._v("Syntax")]),t._v(" : lsapi_use_default_uid On/Off"),a("br"),t._v(" "),a("strong",[t._v("Default")]),t._v(" : lsapi_use_default_uid On"),a("br"),t._v(" "),a("strong",[t._v("Context")]),t._v(" : httpd.conf")]),t._v(" "),a("p",[a("strong",[t._v("Description")]),t._v(" :"),a("br"),t._v("\nUse default Apache UID/GID if no uid/gid set. Values: On/Off. If Off, and no UID/GID set, error 503 will be returned.")]),t._v(" "),a("hr"),t._v(" "),a("h4",{attrs:{id:"lsapi-target-perm"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#lsapi-target-perm","aria-hidden":"true"}},[t._v("#")]),t._v(" "),a("strong",[t._v("lsapi_target_perm")])]),t._v(" "),a("p",[a("strong",[t._v("Syntax")]),t._v(" : lsapi_target_perm On/Off"),a("br"),t._v(" "),a("strong",[t._v("Default")]),t._v(" : lsapi_target_perm Off"),a("br"),t._v(" "),a("strong",[t._v("Context")]),t._v(" : httpd.conf")]),t._v(" "),a("p",[a("strong",[t._v("Description")]),t._v(" :"),a("br"),t._v("\nCheck target PHP script permissions. If set to On, lsapi will check that script is owned by the same user, as user under which it is being executed. Return 503 error if they don't match. Default: Off.")]),t._v(" "),a("hr"),t._v(" "),a("h4",{attrs:{id:"lsapi-paranoid"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#lsapi-paranoid","aria-hidden":"true"}},[t._v("#")]),t._v(" "),a("strong",[t._v("lsapi_paranoid")])]),t._v(" "),a("p",[a("strong",[t._v("Syntax")]),t._v(" : lsapi_paranoid On/Off"),a("br"),t._v(" "),a("strong",[t._v("Default")]),t._v(" : lsapi_paranoid Off"),a("br"),t._v(" "),a("strong",[t._v("Context")]),t._v(" : httpd.conf")]),t._v(" "),a("p",[a("strong",[t._v("Description")]),t._v(" :"),a("br"),t._v("\nCheck or not permissions of target php scripts. Optional, default value is Off.")]),t._v(" "),a("hr"),t._v(" "),a("h4",{attrs:{id:"lsapi-check-document-root"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#lsapi-check-document-root","aria-hidden":"true"}},[t._v("#")]),t._v(" "),a("strong",[t._v("lsapi_check_document_root")])]),t._v(" "),a("p",[a("strong",[t._v("Syntax")]),t._v(" : lsapi_check_document_root On/Off"),a("br"),t._v(" "),a("strong",[t._v("Default")]),t._v(" : lsapi_check_document_root On"),a("br"),t._v(" "),a("strong",[t._v("Context")]),t._v(" : httpd.conf")]),t._v(" "),a("p",[a("strong",[t._v("Description")]),t._v(" :"),a("br"),t._v("\nCheck or not owner of DOCUMENT_ROOT. Optional, default value is On.")]),t._v(" "),a("hr"),t._v(" "),a("h4",{attrs:{id:"lsapi-disable-forced-pwd-var"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#lsapi-disable-forced-pwd-var","aria-hidden":"true"}},[t._v("#")]),t._v(" "),a("strong",[t._v("lsapi_disable_forced_pwd_var")])]),t._v(" "),a("p",[a("strong",[t._v("Syntax")]),t._v(" : lsapi_disable_forced_pwd_var On/Off"),a("br"),t._v(" "),a("strong",[t._v("Default")]),t._v(" : lsapi_disable_forced_pwd_var Off"),a("br"),t._v(" "),a("strong",[t._v("Context")]),t._v(" : httpd.conf, virtualhost")]),t._v(" "),a("p",[a("strong",[t._v("Description")]),t._v(" :"),a("br"),t._v("\nTo disable addition of PWD variable. Default value is Off. If set to On, the PWD variable will not be added into a backend environment.")]),t._v(" "),a("hr"),t._v(" "),a("h4",{attrs:{id:"lsapi-max-resend-buffer"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#lsapi-max-resend-buffer","aria-hidden":"true"}},[t._v("#")]),t._v(" "),a("strong",[t._v("lsapi_max_resend_buffer")])]),t._v(" "),a("p",[a("strong",[t._v("Syntax")]),t._v(" : lsapi_max_resend_buffer [number]tmp"),a("br"),t._v(" "),a("strong",[t._v("Default")]),t._v(" : lsapi_max_resend_buffer 200"),a("br"),t._v(" "),a("strong",[t._v("Context")]),t._v(" : httpd.conf, virtualhost")]),t._v(" "),a("p",[a("strong",[t._v("Description")]),t._v(" :"),a("br"),t._v("\nMaximum buffer in KiB to resend for request that has a body (like POST request body).")]),t._v(" "),a("h2",{attrs:{id:"installation"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#installation","aria-hidden":"true"}},[t._v("#")]),t._v(" Installation")]),t._v(" "),a("p",[t._v("mod_lsapi PRO can be installed through YUM package manager, however, the installation process varies depending on the control panel.")]),t._v(" "),a("p",[t._v("Select the control panel you are using:")]),t._v(" "),a("ul",[a("li",[a("router-link",{attrs:{to:"/apache_mod_lsapi/#cpanel"}},[t._v("cPanel")])],1),t._v(" "),a("li",[a("router-link",{attrs:{to:"/apache_mod_lsapi/#plesk"}},[t._v("Plesk")])],1),t._v(" "),a("li",[a("router-link",{attrs:{to:"/apache_mod_lsapi/#directadmin"}},[t._v("DirectAdmin")])],1),t._v(" "),a("li",[a("router-link",{attrs:{to:"/apache_mod_lsapi/#no-control-panel"}},[t._v("No control panel")])],1)]),t._v(" "),a("h3",{attrs:{id:"cpanel"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#cpanel","aria-hidden":"true"}},[t._v("#")]),t._v(" cPanel")]),t._v(" "),a("p",[a("strong",[t._v("Installing on cPanel servers with EasyApache 4")])]),t._v(" "),a("p",[t._v("Install mod_lsapi PRO and related packages through YUM package manager as follows:\n")]),a("div",{staticClass:"notranslate"},[a("p"),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("$ yum install liblsapi liblsapi-devel\n$ yum install ea-apache24-mod_lsapi\n")])])])]),t._v("\nAfter installing mod_lsapi PRO packages run the next command to setup mod_lsapi to cPanel:\n"),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("$ /usr/bin/switch_mod_lsapi --setup\n")])])])]),t._v("\nNow, when the module is installed, restart Apache to ensure that the mod_lsapi PRO is enabled:\n"),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("$ service httpd restart\n")])])])]),t._v("\nNow the lsapi handler is available for managing through cPanel MultiPHP Manager.\n"),a("p",[t._v("For more details about swith_mod_lsapi, please visit "),a("router-link",{attrs:{to:"/apache_mod_lsapi/#switch-mod-lsapi-tool"}},[t._v("switch_mod_lsapi tool")]),t._v(" .")],1),t._v(" "),a("h3",{attrs:{id:"plesk"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#plesk","aria-hidden":"true"}},[t._v("#")]),t._v(" Plesk")]),t._v(" "),a("p",[a("strong",[t._v("Installing on Plesk servers")])]),t._v(" "),a("p",[t._v("Install mod_lsapi PRO and related packages through YUM package manager as follows:\n")]),a("div",{staticClass:"notranslate"},[a("p"),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("$ yum install liblsapi liblsapi-devel\n$ yum install mod_lsapi\n")])])])]),t._v("\nOnce completed, run the command to setup mod_lsapi PRO and register LSPHP handlers to Plesk Panel:\n"),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("$ /usr/bin/switch_mod_lsapi --setup\n")])])])]),t._v(" "),a("p",[t._v("Now, when the module is installed, restart Apache to ensure that mod_lsapi PRO is enabled:\n")]),a("div",{staticClass:"notranslate"},[a("p"),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("$ service httpd restart\n")])])])]),t._v(" "),a("p",[t._v("Now LSPHPXY alt-php PHP handlers are available for managing through Plesk PHP Settings.")]),t._v(" "),a("p",[a("img",{attrs:{src:"/images/plesk-php-settings.png",alt:""}})]),t._v(" "),a("p",[t._v("For more details about swith_mod_lsapi, please visit "),a("router-link",{attrs:{to:"/apache_mod_lsapi/#switch-mod-lsapi-tool"}},[t._v("switch_mod_lsapi tool")]),t._v(" .")],1),t._v(" "),a("h3",{attrs:{id:"directadmin"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#directadmin","aria-hidden":"true"}},[t._v("#")]),t._v(" DirectAdmin")]),t._v(" "),a("p",[a("strong",[t._v("Installing on DirectAdmin servers")])]),t._v(" "),a("p",[t._v("Installation process is done with custombuild script:\n")]),a("div",{staticClass:"notranslate"},[a("p"),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("$ cd /usr/local/directadmin/custombuild\n$ ./build update\n$ ./build set php1_mode lsphp\n$ ./build php n\n$ ./build apache\n")])])])]),t._v("\nRestart Apache afterwards:\n"),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("$ service httpd restart\n")])])])]),t._v("\nNow all domains under php1_mode are using lsphp handler and no further actions are required to enable mod_lsapi PRO on DirectAdmin.\n"),a("h3",{attrs:{id:"no-control-panel"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#no-control-panel","aria-hidden":"true"}},[t._v("#")]),t._v(" No control panel")]),t._v(" "),a("p",[a("strong",[t._v("Installing on servers with no control panel")])]),t._v(" "),a("p",[t._v("Install mod_lsapi PRO and related packages through YUM package manager as follows:\n")]),a("div",{staticClass:"notranslate"},[a("p"),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("$ yum install liblsapi liblsapi-devel\n$ yum install mod_lsapi\n")])])])]),t._v("\nOnce completed, run a command to setup mod_lsapi PRO:\n"),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("$ /usr/bin/switch_mod_lsapi --setup\n")])])])]),t._v("\nNow, when the module is installed, restart Apache to ensure that mod_lsapi PRO is enabled:\n"),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("$ service httpd restart\n")])])])]),t._v(" "),a("p",[t._v("If you are using an alternative Apache - "),a("a",{attrs:{href:"https://www.cloudlinux.com/cloudlinux-os-blog/entry/httpd24-updated-for-cloudlinux-6",target:"_blank",rel:"noopener noreferrer"}},[t._v("httpd24"),a("OutboundLink")],1),t._v(" , then install mod_lsapi as follows:")]),t._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("$ yum install liblsapi liblsapi-devel\n$ yum install httpd24-mod_lsapi\n")])])])]),t._v("\nOnce completed, run a command to setup mod_lsapi PRO:\n"),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("$ /usr/bin/switch_mod_lsapi --setup\n")])])])]),t._v("\nNow, when the module is installed, restart Apache to ensure that mod_lsapi PRO is enabled:\n"),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("$ service httpd24 restart\n")])])])]),t._v(" "),a("p",[t._v("For more details about swith_mod_lsapi, please visit "),a("router-link",{attrs:{to:"/apache_mod_lsapi/#switch-mod-lsapi-tool"}},[t._v("switch_mod_lsapi tool")]),t._v(" .")],1),t._v(" "),a("h2",{attrs:{id:"uninstall"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#uninstall","aria-hidden":"true"}},[t._v("#")]),t._v(" Uninstall")]),t._v(" "),a("p",[t._v("Uninstall mod_lsapi PRO is performed depending on your control panel.")]),t._v(" "),a("p",[t._v("Select the control panel you are using:")]),t._v(" "),a("ul",[a("li",[a("router-link",{attrs:{to:"/apache_mod_lsapi/#cpanel"}},[t._v("cPanel")])],1),t._v(" "),a("li",[a("router-link",{attrs:{to:"/apache_mod_lsapi/#plesk"}},[t._v("Plesk")])],1),t._v(" "),a("li",[a("router-link",{attrs:{to:"/apache_mod_lsapi/#directadmin"}},[t._v("DirectAdmin")])],1),t._v(" "),a("li",[a("router-link",{attrs:{to:"/apache_mod_lsapi/#no-control-panel"}},[t._v("No control panel")])],1)]),t._v(" "),a("h3",{attrs:{id:"cpanel-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#cpanel-2","aria-hidden":"true"}},[t._v("#")]),t._v(" cPanel")]),t._v(" "),a("p",[a("strong",[t._v("Uninstall procedure for cPanel servers with EasyApache 4")])]),t._v(" "),a("p",[t._v("To remove lsapi handler from cPanel MultiPHP Manager and uninstall mod_lsapi PRO, run a command:\n")]),a("div",{staticClass:"notranslate"},[a("p"),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("$ /usr/bin/switch_mod_lsapi --uninstall\n")])])])]),t._v("\nThen remove packages with YUM package manager:\n"),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("$ yum erase liblsapi liblsapi-devel ea-apache24-mod_lsapi\n")])])])]),t._v("\nRestart Apache afterwards:\n"),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("$ service httpd restart\n")])])])]),t._v("\nNow mod_lsapi PRO is fully uninstalled.\n"),a("h3",{attrs:{id:"plesk-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#plesk-2","aria-hidden":"true"}},[t._v("#")]),t._v(" Plesk")]),t._v(" "),a("p",[a("strong",[t._v("Uninstall procedure for Plesk servers")])]),t._v(" "),a("p",[t._v("To unregister LSPHP handlers and uninstall mod_lsapi PRO, run the command:\n")]),a("div",{staticClass:"notranslate"},[a("p"),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("$ /usr/bin/switch_mod_lsapi --uninstall\n")])])])]),t._v("\nThen remove packages with YUM package manager:\n"),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("$ yum erase liblsapi liblsapi-devel mod_lsapi\n")])])])]),t._v("\nRestart Apache afterwards:\n"),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("$ service httpd restart\n")])])])]),t._v("\nNow LSPHPXY alt-php PHP handlers and mod_lsapi PRO are fully uninstalled.\n"),a("h3",{attrs:{id:"directadmin-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#directadmin-2","aria-hidden":"true"}},[t._v("#")]),t._v(" DirectAdmin")]),t._v(" "),a("p",[a("strong",[t._v("Uninstall procedure for DirectAdmin servers")])]),t._v(" "),a("p",[t._v("Uninstall is done with custombuild script:\n")]),a("div",{staticClass:"notranslate"},[a("p"),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("$ cd /usr/local/directadmin/custombuild\n$ ./build update\n$ ./build set php1_release [any other php mode]\n$ ./build php n\n$ ./build apache\n")])])])]),t._v("\nThe following PHP modes are available for DirectAdmin:\n"),a("ul",[a("li",[t._v("mod_php")]),t._v(" "),a("li",[t._v("fastcgi")]),t._v(" "),a("li",[t._v("php-fpm")]),t._v(" "),a("li",[t._v("suphp")])]),t._v(" "),a("p",[t._v("Restart Apache afterwards:\n")]),a("div",{staticClass:"notranslate"},[a("p"),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("$ service httpd restart\n")])])])]),t._v("\nNow all domains under php1_mode are using the chosen handler and mod_lsapi PRO is fully uninstalled.\n"),a("h3",{attrs:{id:"no-control-panel-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#no-control-panel-2","aria-hidden":"true"}},[t._v("#")]),t._v(" No control panel")]),t._v(" "),a("p",[a("strong",[t._v("Uninstall procedure for servers with no control panel")])]),t._v(" "),a("p",[t._v("To uninstall mod_lsapi PRO, run the command:\n")]),a("div",{staticClass:"notranslate"},[a("p"),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("$ /usr/bin/switch_mod_lsapi --uninstall\n")])])])]),t._v("\nThen remove packages with YUM package manager:\n"),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("$ yum erase liblsapi liblsapi-devel mod_lsapi\n$ rm [path to mod_lsapi.conf]\n")])])])]),t._v("\nRestart Apache to restore the standard PHP handler:\n"),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("$ service httpd restart\n")])])])]),t._v(" "),a("p",[t._v("If you are using an alternative Apache: - "),a("a",{attrs:{href:"https://www.cloudlinux.com/cloudlinux-os-blog/entry/httpd24-updated-for-cloudlinux-6",target:"_blank",rel:"noopener noreferrer"}},[t._v("httpd24"),a("OutboundLink")],1),t._v(" , then uninstall mod_lsapi PRO as follows:")]),t._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("$ /usr/bin/switch_mod_lsapi --uninstall\n")])])])]),t._v("\nThen remove packages with YUM package manager:\n"),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("$ yum erase liblsapi liblsapi-devel httpd24-mod_lsapi\n$ rm [path to mod_lsapi.conf]\n")])])])]),t._v("\nRestart Apache afterwards:\n"),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("$ service httpd24 restart\n")])])])]),t._v("\nNow mod_lsapi PRO is fully uninstalled.\n"),a("h2",{attrs:{id:"switch-mod-lsapi-tool"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#switch-mod-lsapi-tool","aria-hidden":"true"}},[t._v("#")]),t._v(" switch_mod_lsapi tool")]),t._v(" "),a("p",[t._v("switch_mod_lsapi is the command line tool used to manage mod_lsapi PRO.")]),t._v(" "),a("p",[t._v("It has the following syntax:")]),t._v(" "),a("p",[a("code",[t._v("/usr/bin/switch_mod_lsapi [OPTIONS]")])]),t._v(" "),a("p",[a("code",[t._v("[OPTIONS]")]),t._v("  can be the main and an additional (for usage together with any other main option).")]),t._v(" "),a("p",[a("strong",[t._v("Main options")])]),t._v(" "),a("table",[a("thead",[a("tr",[a("th"),t._v(" "),a("th")])]),t._v(" "),a("tbody",[a("tr",[a("td",[a("strong",[t._v("Option")])]),t._v(" "),a("td",[a("strong",[t._v("Description")])])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("--setup")])]),t._v(" "),a("td",[t._v("setup "),a("em",[t._v("mod_lsapi")]),t._v(" configurations for Apache, including PHP handlers setup; create native lsphp (if it doesn't exist) by doing: "),a("code",[t._v("cp /opt/alt/php56/usr/bin/lsphp /usr/local/bin/")]),t._v(" "),a("br"),t._v(" "),a("em",[t._v("* NOT supported for DirectAdmin")])])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("--setup-light")])]),t._v(" "),a("td",[t._v("setup PHP handlers only"),a("br"),t._v(" "),a("em",[t._v("* supported for cPanel EasyApache 4 only")])])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("--uninstall")])]),t._v(" "),a("td",[t._v("uninstall "),a("em",[t._v("mod_lsapi")]),t._v(" from Apache"),a("br"),t._v(" "),a("em",[t._v("* supported for cPanel (EasyApache 3 and EasyApache 4), Plesk, and servers without control panel")])])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("--enable-domain")])]),t._v(" "),a("td",[t._v("enable "),a("em",[t._v("mod_lsapi")]),t._v(" for individual domain"),a("br"),t._v(" "),a("em",[t._v("* supported for cPanel EasyApache 3 only")])])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("--disable-domain")])]),t._v(" "),a("td",[t._v("disable "),a("em",[t._v("mod_lsapi")]),t._v(" for individual domain"),a("br"),t._v(" "),a("em",[t._v("* supported for cPanel EasyApache 3 only")])])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("--enable-global")])]),t._v(" "),a("td",[t._v("sets up "),a("em",[t._v("mod_lsapi")]),t._v(" as a default way to serve PHP, making it enabled for all domains. Once that mode is enabled, you cannot disable "),a("em",[t._v("mod_lsapi")]),t._v(" for an individual domain."),a("br"),t._v(" "),a("em",[t._v("* supported for cPanel only (EasyApache 3 and EasyApache 4)")])])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("--disable-global")])]),t._v(" "),a("td",[t._v("disable "),a("em",[t._v("mod_lsapi")]),t._v(" as a default way to serve PHP, disabling "),a("em",[t._v("mod_lsapi")]),t._v(" for all domains, including those selected earlier using"),a("br"),t._v(" "),a("em",[t._v("--enable-domain")]),t._v(" "),a("em",[t._v("* supported for cPanel EasyApache 3 only")])])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("--build-native-lsphp")])]),t._v(" "),a("td",[t._v("build native "),a("em",[t._v("lsphp")]),t._v(" for cPanel EasyApache 3"),a("br"),t._v(" "),a("em",[t._v("* supported for cPanel EasyApache 3 only")])])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("--build-native-lsphp-cust")])]),t._v(" "),a("td",[t._v("build native "),a("em",[t._v("lsphp")]),t._v(" for cPanel EasyApache 3 (with custom PHP source path)"),a("br"),t._v(" "),a("em",[t._v("* supported for cPanel EasyApache 3 only")])])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("--check-php")])]),t._v(" "),a("td",[t._v("check PHP configuration"),a("br"),t._v(" "),a("em",[t._v("* NOT supported for DirectAdmin")])])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("--stat")])]),t._v(" "),a("td",[t._v("return usage statistics in JSON format; the following statistics metrics are collected:"),a("br"),t._v(" • control panel name;"),a("br"),t._v(" • mod_lsapi version;"),a("br"),t._v(" • liblsapi version;"),a("br"),t._v(" • criu version and status;"),a("br"),t._v(" • whether mod_lsapi is enabled;"),a("br"),t._v(" • lsapi configuration options;"),a("br"),t._v(" • number of domains, that use "),a("em",[t._v("mod_lsapi")]),t._v(", per each installed PHP version including those set in PHP Selector "),a("em",[t._v("(this metric is supported for cPanel EasyApache 4, Plesk and DirectAdmin)")]),t._v(" .")])])])]),t._v(" "),a("p",[a("strong",[t._v("Additional options")])]),t._v(" "),a("table",[a("thead",[a("tr",[a("th"),t._v(" "),a("th")])]),t._v(" "),a("tbody",[a("tr",[a("td",[a("strong",[t._v("Option")])]),t._v(" "),a("td",[a("strong",[t._v("Description")])])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("--verbose")])]),t._v(" "),a("td",[t._v("switch verbose level on")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("--force")])]),t._v(" "),a("td",[t._v("switch force mode on")])])])]),t._v(" "),a("p",[t._v("The following table presents which "),a("code",[t._v("[OPTIONS]")]),t._v(" are supported for various panels:")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th"),t._v(" "),a("th"),t._v(" "),a("th"),t._v(" "),a("th"),t._v(" "),a("th"),t._v(" "),a("th"),t._v(" "),a("th"),t._v(" "),a("th")])]),t._v(" "),a("tbody",[a("tr",[a("td"),t._v(" "),a("td",[t._v("No Control Panel")]),t._v(" "),a("td",[t._v("cPanel EA3")]),t._v(" "),a("td",[t._v("cPanel EA4")]),t._v(" "),a("td",[t._v("DirectAdmin")]),t._v(" "),a("td",[t._v("Plesk")]),t._v(" "),a("td",[t._v("InterWorx")]),t._v(" "),a("td",[t._v("ISPManager")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("setup")])]),t._v(" "),a("td",[t._v("+")]),t._v(" "),a("td",[t._v("+")]),t._v(" "),a("td",[t._v("+")]),t._v(" "),a("td",[t._v("custombuild")]),t._v(" "),a("td",[t._v("+")]),t._v(" "),a("td",[t._v("+")]),t._v(" "),a("td",[t._v("+")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("setup-light")])]),t._v(" "),a("td",[t._v("-")]),t._v(" "),a("td",[t._v("-")]),t._v(" "),a("td",[t._v("+")]),t._v(" "),a("td",[t._v("-")]),t._v(" "),a("td",[t._v("-")]),t._v(" "),a("td",[t._v("-")]),t._v(" "),a("td",[t._v("-")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("uninstall")])]),t._v(" "),a("td",[t._v("+")]),t._v(" "),a("td",[t._v("+")]),t._v(" "),a("td",[t._v("+")]),t._v(" "),a("td",[t._v("custombuild")]),t._v(" "),a("td",[t._v("+")]),t._v(" "),a("td",[t._v("+")]),t._v(" "),a("td",[t._v("+")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("enable-domain")])]),t._v(" "),a("td",[t._v("-")]),t._v(" "),a("td",[t._v("+")]),t._v(" "),a("td",[t._v("-")]),t._v(" "),a("td",[t._v("-")]),t._v(" "),a("td",[t._v("-")]),t._v(" "),a("td",[t._v("-")]),t._v(" "),a("td",[t._v("-")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("disable-domain")])]),t._v(" "),a("td",[t._v("-")]),t._v(" "),a("td",[t._v("+")]),t._v(" "),a("td",[t._v("-")]),t._v(" "),a("td",[t._v("-")]),t._v(" "),a("td",[t._v("-")]),t._v(" "),a("td",[t._v("-")]),t._v(" "),a("td",[t._v("-")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("enable-global")])]),t._v(" "),a("td",[t._v("-")]),t._v(" "),a("td",[t._v("+")]),t._v(" "),a("td",[t._v("+")]),t._v(" "),a("td",[t._v("custombuild")]),t._v(" "),a("td",[t._v("-")]),t._v(" "),a("td",[t._v("-")]),t._v(" "),a("td",[t._v("-")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("disable-global")])]),t._v(" "),a("td",[t._v("-")]),t._v(" "),a("td",[t._v("+")]),t._v(" "),a("td",[t._v("-")]),t._v(" "),a("td",[t._v("custombuild")]),t._v(" "),a("td",[t._v("-")]),t._v(" "),a("td",[t._v("-")]),t._v(" "),a("td",[t._v("-")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("build-native-lsphp")])]),t._v(" "),a("td",[t._v("-")]),t._v(" "),a("td",[t._v("+")]),t._v(" "),a("td",[t._v("-")]),t._v(" "),a("td",[t._v("-")]),t._v(" "),a("td",[t._v("-")]),t._v(" "),a("td",[t._v("-")]),t._v(" "),a("td",[t._v("-")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("build-native-lsphp-cust")])]),t._v(" "),a("td",[t._v("-")]),t._v(" "),a("td",[t._v("+")]),t._v(" "),a("td",[t._v("-")]),t._v(" "),a("td",[t._v("-")]),t._v(" "),a("td",[t._v("-")]),t._v(" "),a("td",[t._v("-")]),t._v(" "),a("td",[t._v("-")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("check-php")])]),t._v(" "),a("td",[t._v("+")]),t._v(" "),a("td",[t._v("+")]),t._v(" "),a("td",[t._v("+")]),t._v(" "),a("td",[t._v("-")]),t._v(" "),a("td",[t._v("+")]),t._v(" "),a("td",[t._v("+")]),t._v(" "),a("td",[t._v("+")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("verbose")])]),t._v(" "),a("td",[t._v("+")]),t._v(" "),a("td",[t._v("+")]),t._v(" "),a("td",[t._v("+")]),t._v(" "),a("td",[t._v("-")]),t._v(" "),a("td",[t._v("+")]),t._v(" "),a("td",[t._v("+")]),t._v(" "),a("td",[t._v("+")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("force")])]),t._v(" "),a("td",[t._v("+")]),t._v(" "),a("td",[t._v("+")]),t._v(" "),a("td",[t._v("+")]),t._v(" "),a("td",[t._v("-")]),t._v(" "),a("td",[t._v("+")]),t._v(" "),a("td",[t._v("+")]),t._v(" "),a("td",[t._v("+")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("stat")])]),t._v(" "),a("td",[t._v("+ "),a("br"),t._v(" "),a("em",[t._v("*without domain info")])]),t._v(" "),a("td",[t._v("+ "),a("br"),t._v(" "),a("em",[t._v("*without domain info")])]),t._v(" "),a("td",[t._v("+")]),t._v(" "),a("td",[t._v("+")]),t._v(" "),a("td",[t._v("+")]),t._v(" "),a("td",[t._v("+ "),a("br"),t._v(" "),a("em",[t._v("*without domain info")])]),t._v(" "),a("td",[t._v("+ "),a("br"),t._v(" "),a("em",[t._v("*without domain info")])])])])]),t._v(" "),a("h2",{attrs:{id:"troubleshooting"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#troubleshooting","aria-hidden":"true"}},[t._v("#")]),t._v(" Troubleshooting")]),t._v(" "),a("p",[a("strong",[t._v("Debugging mod_lsapi issues: error_log & sulsphp_log")])]),t._v(" "),a("p",[t._v("mod_lsapi errors will be located in error_log and sulsphp_log.\nNote that errors can appear in both logs at the same time, and you might need to refer to both of them to solve the issue.")]),t._v(" "),a("p",[t._v("See next table for more details:")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th"),t._v(" "),a("th"),t._v(" "),a("th")])]),t._v(" "),a("tbody",[a("tr",[a("td",[a("strong",[t._v("error_log")])]),t._v(" "),a("td",[a("strong",[t._v("sulsphp_log")])]),t._v(" "),a("td",[a("strong",[t._v("Solution")])])]),t._v(" "),a("tr",[a("td",[t._v("Could not connect to lsphp backend: connect to lsphp failed: 111 Connection refused. Increase memory limit for LVE ID")]),t._v(" "),a("td",[t._v("uid: (xxx/xxxxxxxx) gid: (xxx/xxxxxxxxxx) cmd: /usr/local/bin/lsphp")]),t._v(" "),a("td",[t._v("Increase pmem or vmem limits for the user uid.")])]),t._v(" "),a("tr",[a("td",[t._v("Error sending request: ReceiveLSHeader: nothing to read from backend socket")]),t._v(" "),a("td",[t._v("No need to check this log.")]),t._v(" "),a("td",[t._v("lsphp was killed. It can be due to apache restart or lfd. If you see this  message too often - change "),a("span",{staticClass:"notranslate"},[t._v("  lsapi_terminate_backends_on_exit ")]),t._v(" to "),a("span",{staticClass:"notranslate"},[t._v(" Off ")]),t._v(" in lsapi.conf or add to "),a("span",{staticClass:"notranslate"},[t._v(" /etc/csf/csf.pignore ")]),t._v(" the following lines: "),a("span",{staticClass:"notranslate"},[t._v(" exe:/usr/local/bin/lsphp ")]),t._v(" pexe:/opt/alt/php.*/usr/bin/lsphp")])]),t._v(" "),a("tr",[a("td",[t._v("Error sending request (lsphp is killed?): ReceiveLSHeader: nothing to read from backend socket, referer: http://XXXXXXX  Child process with pid: XXXXX was killed by signal: 11, core dump: 0")]),t._v(" "),a("td",[t._v("No need to check this log.")]),t._v(" "),a("td",[t._v("lsphp has crashed. Next slide will explain what to do (core dump creating). Also, check configuration options for apc and suhosin in php.ini. Once you have a core file generated at DocumentRoot contact "),a("a",{attrs:{href:"https://cloudlinux.zendesk.com/hc/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://cloudlinux.zendesk.com/"),a("OutboundLink")],1),t._v(" so we can investigate the cause.")])]),t._v(" "),a("tr",[a("td",[t._v("Could not connect to lsphp backend: connect to lsphp failed: 111 Connection refused")]),t._v(" "),a("td",[t._v("file is writable by others: (///usr/local/bin/lsphp)")]),t._v(" "),a("td",[t._v("Incorrect lsphp file permissions. For fixing: "),a("span",{staticClass:"notranslate"},[t._v(" chmod 755 /usr/local/bin/lsphp ")]),t._v(" cagefsctl --force-update.")])]),t._v(" "),a("tr",[a("td",[t._v("Could not determine uid/gid for request")]),t._v(" "),a("td",[t._v("No need to check this log.")]),t._v(" "),a("td",[t._v("UID/GID are not set in  virtualhost. Set "),a("span",{staticClass:"notranslate"},[t._v(" lsapi_use_default_uid On ")]),t._v(" in lsapi.conf (it is "),a("span",{staticClass:"notranslate"},[t._v(" On ")]),t._v(" by default since 0.1-98 version, this solution is for older versions).")])]),t._v(" "),a("tr",[a("td",[t._v("Own id for script file (/xxxx/xxx/xxxx) is xxx; should be xxxx")]),t._v(" "),a("td",[t._v("No need to check this log.")]),t._v(" "),a("td",[t._v("File is not owned by the user PHP executed by. To overwrite (insecure), set "),a("span",{staticClass:"notranslate"},[t._v(" lsapi_target_perm Off ")]),t._v(" in lsapi.conf.")])]),t._v(" "),a("tr",[a("td",[t._v("Could not connect to lsphp backend: connect to lsphp failed: 111 Connection refused")]),t._v(" "),a("td",[t._v("Entering jail error")]),t._v(" "),a("td",[t._v("Check if СageFS enabled. Try running "),a("span",{staticClass:"notranslate"},[t._v(" cagefsctl --remount-all. ")])])]),t._v(" "),a("tr",[a("td",[t._v("connect_lsphp: connect to lsphp failed: tries XXX exceeded with timeout XXXXX  Could not connect to lsphp backend: connect to lsphp failed: 111 Connection refused")]),t._v(" "),a("td",[t._v("uid: (xxx/xxxxxxxx)  gid: (xxx/xxxxxxxxxx)  cmd: /usr/local/bin/lsphp")]),t._v(" "),a("td",[t._v("Check if "),a("span",{staticClass:"notranslate"},[t._v(" /tmp/lshttpd (global /tmp ")]),t._v(" is not inside CageFS) exists and owner should be apache: apache for DirectAdmin, Plesk, iWorx, ISPManager and nobody for cPanel.")])]),t._v(" "),a("tr",[a("td",[t._v("Backend error on sending request(GET /XXXX HTTP/1.1); uri(/XXXX) content-length(0) (lsphp is killed?): ReceiveAckHdr: backend process reset connection: errno 104 (possibly memory limit for LVE ID XXXX too small)")]),t._v(" "),a("td",[t._v("uid: (xxx/xxxxxxxx)  gid: (xxx/xxxxxxxxxx)  cmd: /usr/local/bin/lsphp")]),t._v(" "),a("td",[t._v("Increase PMEM limits for the user UID.")])]),t._v(" "),a("tr",[a("td",[t._v("Reached max children process limit: XX, extra: 0, current: XX, please increase LSAPI_CHILDREN."),a("br"),a("br"),t._v("Backend error on sending request(GET /XXXX HTTP/1.1); uri(/XXXX) content-length(0) (lsphp is killed?): ReceiveAckHdr: backend process reset connection: errno 104 (possibly memory limit for LVE ID XXXX too small)")]),t._v(" "),a("td",[t._v("uid: (xxx/xxxxxxxx)  gid: (xxx/xxxxxxxxxx)  cmd: /usr/local/bin/lsphp")]),t._v(" "),a("td",[t._v("Increase value of "),a("span",{staticClass:"notranslate"},[t._v(" lsapi_backend_children ")]),t._v(" for UID in vhost.conf or globally in lsapi.conf.")])]),t._v(" "),a("tr",[a("td",[t._v("fork() failed, please increase process limit: Cannot allocate memory"),a("br"),a("br"),t._v("Backend error on sending request(GET /XXXX HTTP/1.1); uri(/XXXX) content-length(0) (lsphp is killed?): ReceiveAckHdr: backend process reset connection: errno 104 (possibly memory limit for LVE ID XXXX too small)")]),t._v(" "),a("td",[t._v("uid:(xxx); gid:(xxx); uid limit warning: EP should be < than NPROC, current EP: XX, NPROC: XX"),a("br"),a("br"),t._v("uid: (xxx/xxxxxxxx) gid: (xxx/xxxxxxxxxx) cmd: /usr/local/bin/lsphp")]),t._v(" "),a("td",[t._v("Increase NPROC limits for the UID. It should be greater than EP and "),a("span",{staticClass:"notranslate"},[t._v(" lsapi_backend_children. ")])])]),t._v(" "),a("tr",[a("td",[t._v("Child process with pid: XXXXXX was killed by signal: 9, core dump: 0"),a("br"),a("br"),t._v("Backend error on sending request(GET /XXXX HTTP/1.1); uri(/XXXX) content-length(0) (lsphp is killed?): ReceiveAckHdr: nothing to read from backend socket (LVE ID XXXX")]),t._v(" "),a("td",[t._v("uid: (xxx/xxxxxxxx) gid: (xxx/xxxxxxxxxx) cmd: /usr/local/bin/lsphp")]),t._v(" "),a("td",[t._v("These errors occurs when the amount of PMEM limits is incommensurable with the number of EP. Increase PMEM limits or decrease EP number for the user UID.")])]),t._v(" "),a("tr",[a("td",[t._v("totBytesRead (X) != bodyLen (X), referer: XXXX"),a("br"),a("br"),t._v("Backend error on sending request(POST /XXXX HTTP/1.1); uri(/XXXX) content-length(X) (lsphp is killed?): ReceiveAckHdr: nothing to read from backend socket (LVE ID XXXX)"),a("br"),a("br"),t._v("lsphp(XXXX): Child process with pid: XXXX was killed by signal: 15, core dump: 0")]),t._v(" "),a("td",[t._v("No need to check this log.")]),t._v(" "),a("td",[t._v("Increase LimitRequestBody (Apache) or/and SecRequestBodyNoFilesLimit (mod_security) configuration limits")])]),t._v(" "),a("tr",[a("td",[t._v("Connect to backend failed: connect to lsphp failed: 13")]),t._v(" "),a("td",[t._v("No need to check this log.")]),t._v(" "),a("td",[t._v("Check that "),a("code",[t._v("mod_ruid2")]),t._v(" is disabled")])]),t._v(" "),a("tr",[a("td",[t._v("Connect to backend rejected on sending request(POST /XXXXX HTTP/1.1); uri(/XXXXX)")]),t._v(" "),a("td",[t._v("No need to check this log.")]),t._v(" "),a("td",[t._v("Set "),a("span",{staticClass:"notranslate"},[a("code",[t._v("lsapi_disable_reject_mode On")])]),t._v(" in your "),a("span",{staticClass:"notranslate"},[a("code",[t._v("lsapi.conf")])]),t._v(" and reload Apache. This way LSPHP daemon will put requests that cannot be served by LSPHP daemon right away into infinite queue, until one or more LSPHP daemon becomes free. Visit "),a("router-link",{attrs:{to:"/apache_mod_lsapi/#configuration-references"}},[t._v("Configuration Reference")]),t._v(" for more info.")],1)])])]),t._v(" "),a("p",[a("strong",[t._v("Non-standard apache user")])]),t._v(" "),a("p",[t._v("If apache runs under a username other than "),a("span",{staticClass:"notranslate"},[t._v(' "apache" ')]),t._v(" or "),a("span",{staticClass:"notranslate"},[t._v(' "nobody" ')]),t._v(" , you should rebuild sulsphp (where username is built in for security reasons) with corresponding username:\n")]),a("div",{staticClass:"notranslate"},[a("p"),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("$ yum install liblsapi liblsapi-devel   \n$ cd ~$ wget [http://repo.cloudlinux.com/cloudlinux/sources/da/mod_lsapi.tar.gz](http://repo.cloudlinux.com/cloudlinux/sources/da/mod_lsapi.tar.gz)  \n$ tar zxvf mod_lsapi.tar.gz  \n$ cd mod-lsapi-0.1-37  \n$ cmake -DHTTPD_USER=<new user name> .  \n$ make\n$ make install\n")])])])]),t._v("\nThis will:"),a("br"),t._v("  \n- Install: "),a("span",{staticClass:"notranslate"},[t._v(" /usr/lib/apache/mod_lsapi. ")]),t._v(" so (or to another correct httpd modules path)"),a("br"),t._v("\n- Install: "),a("span",{staticClass:"notranslate"},[t._v(" /usr/sbin/sulsphp ")]),t._v(" "),a("p",[a("strong",[t._v("lsphp started under user apache/nobody")])]),t._v(" "),a("p",[t._v("Check if SuExecUserGroup specified for virtual hosts. This parameter is used by mod_lsapi for user identification.")]),t._v(" "),a("p",[a("strong",[t._v("Could not connect to lsphp backend: connect(/tmp/lshttpd/lsapi_application-x-httpd-lsphp_XXX.sock) failed: 111 Connection refused")])]),t._v(" "),a("ul",[a("li",[a("p",[t._v("Switch in lsapi.conf or "),a("span",{staticClass:"notranslate"},[t._v(" mod_lsapi.conf ")]),t._v(" value to: "),a("span",{staticClass:"notranslate"},[t._v(" lsapi_terminate_backends_on_exit Off ")])])]),t._v(" "),a("li",[a("p",[t._v("Check if empty: "),a("span",{staticClass:"notranslate"},[t._v(" cat /etc/cron.d/kill_orphaned_php-cron | grep lsphp ")]),t._v(" , then run:")])])]),t._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("yum install lve-utils\n")])])])]),t._v("\nThen restart cron service.\n"),a("p",[a("strong",[t._v("Running PHP for users with UID < 99")])]),t._v(" "),a("p",[t._v("If you need to run PHP using mod_lsapi using users with UID < 99, you would need to re-compile sulsphp:")]),t._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("$ yum install liblsapi liblsapi-devel\n$ cd ~\n$ wget [http://repo.cloudlinux.com/cloudlinux/sources/da/mod_lsapi.tar.gz](http://repo.cloudlinux.com/cloudlinux/sources/da/mod_lsapi.tar.gz)\n$ tar zxvf mod_lsapi.tar.gz\n$ cd mod-lsapi-0.1-XX\n$ cmake -DUID_MIN=80 -DGID_MIN=80 .\n$ make\n$ make install\n")])])])]),t._v("\nwill be installed"),a("br"),t._v("  \n- Installing: "),a("span",{staticClass:"notranslate"},[t._v(" /usr/lib/apache/mod_lsapi.so ")]),t._v(" (or another httpd modules path)"),a("br"),t._v("\n- Installing: "),a("span",{staticClass:"notranslate"},[t._v(" /usr/sbin/sulsphp ")]),t._v(" "),a("p",[a("strong",[t._v("Apache binary called not httpd (httpd.event, httpd.worker)")])]),t._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('$ yum install liblsapi liblsapi-devel \n$ cd ~\n$ wget http://repo.cloudlinux.com/cloudlinux/sources/da/mod_lsapi.tar.gz        \n$ tar zxvf mod_lsapi.tar.gz\n$ cd mod-lsapi-0.1-XX\n$ cmake -DPARENT_NAME="<apache binary name>".\n$ make\n$ make install\n')])])])]),t._v("\nWill be installed:"),a("br"),t._v("\n- Installing: "),a("span",{staticClass:"notranslate"},[t._v(" /usr/lib/apache/mod_lsapi.so ")]),t._v(" (or another httpd modules path)"),a("br"),t._v("\n- Installing: "),a("span",{staticClass:"notranslate"},[t._v(" /usr/sbin/sulsphp ")]),t._v(" "),a("p",[a("strong",[t._v("WHMCS Status page not accessible after installing CL and mod_lsapi (cPanel).")])]),t._v(" "),a("ul",[a("li",[t._v("add "),a("span",{staticClass:"notranslate"},[t._v(" user: useradd ")]),t._v(" userstat")]),t._v(" "),a("li",[t._v("add to file (to the end of file before "),a("span",{staticClass:"notranslate"},[t._v(") /usr/local/apache/conf/conf.d/lsapi.conf: <Directory /usr/local/apache/htdocs/>  ")]),t._v("\nlsapi_user_group userstat userstat\n")]),t._v(" "),a("li",[t._v("service httpd restart")])]),t._v(" "),a("p",[t._v("This is safe solution for easyapache rebuilding and cpanel-mod-lsapi updating.")]),t._v(" "),a("p",[a("strong",[t._v("PHP page with Suhosin return 503 error")])]),t._v(" "),a("p",[t._v("Make php.ini for suhosin as recommended below:\n")]),a("div",{staticClass:"notranslate"},[a("p"),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("[suhosin]\nsuhosin.simulation = Off\nsuhosin.mail.protect = 1\nsuhosin.cookie.disallow_nul = Off\nsuhosin.cookie.max_array_depth = 1000\nsuhosin.cookie.max_array_index_length = 500\nsuhosin.cookie.max_name_length = 500\nsuhosin.cookie.max_totalname_length = 500\nsuhosin.cookie.max_value_length = 200000\nsuhosin.cookie.max_vars = 16384\nsuhosin.get.disallow_nul = Off\nsuhosin.get.max_array_depth = 1000\nsuhosin.get.max_array_index_length = 500\nsuhosin.get.max_name_length = 500\nsuhosin.get.max_totalname_length = 500\nsuhosin.get.max_value_length = 1000000\nsuhosin.get.max_vars = 16384\nsuhosin.post.disallow_nul = Off\nsuhosin.post.max_array_depth = 1000\nsuhosin.post.max_array_index_length = 500\nsuhosin.post.max_name_length = 500\nsuhosin.post.max_totalname_length = 500\nsuhosin.post.max_value_length = 1000000\nsuhosin.post.max_vars = 16384\nsuhosin.request.disallow_nul = Off\nsuhosin.request.max_array_depth = 1000\nsuhosin.request.max_array_index_length = 500\nsuhosin.request.max_totalname_length = 500\nsuhosin.request.max_value_length = 1000000\nsuhosin.request.max_vars = 16384\nsuhosin.request.max_varname_length = 524288\nsuhosin.upload.max_uploads = 300\nsuhosin.upload.disallow_elf = Off\nsuhosin.session.cryptua = Off\nsuhosin.session.encrypt = Off\nsuhosin.session.max_id_length = 1024\nsuhosin.executor.allow_symlink = Off\nsuhosin.executor.disable_eval = Off\nsuhosin.executor.disable_emodifier = Off\nsuhosin.executor.include.max_traversal = 8\n")])])])]),t._v(" "),a("p",[a("strong",[t._v("PHP page with APC return 503 error")])]),t._v(" "),a("p",[t._v("Make php.ini for APC as recommended below:\n")]),a("div",{staticClass:"notranslate"},[a("p"),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("[apc]...apc.shm_segments=1apc.shm_size=32...\n")])])])]),t._v("\nshared memory should be not less than 32MB\n"),a("p",[a("strong",[t._v("Messages appearing in error_log: Child process with pid: XXXXX was killed by signal: 11, core dump: 0")])]),t._v(" "),a("p",[t._v("This means that lsphp was crashed. The solution is:")]),t._v(" "),a("ul",[a("li",[t._v("Check if apc for user enabled. Tune its options as described in previous slide.")]),t._v(" "),a("li",[t._v("Check if suhosin is enabled for user. Tune its options as described in this article.")]),t._v(" "),a("li",[t._v("If previous items do not help, contact us at "),a("a",{attrs:{href:"https://helpdesk.cloudlinux.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://helpdesk.cloudlinux.com/"),a("OutboundLink")],1)])]),t._v(" "),a("p",[a("strong",[t._v("How to get lsphp core dump on crash")])]),t._v(" "),a("ul",[a("li",[t._v("Configure mod_lsapi to allow lsphp to generate core dumps. In mod_lsapi.conf:")])]),t._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("lsapi_backend_coredump On\n")])])])]),t._v(" "),a("ul",[a("li",[t._v("Enable core file generation in sysctl:")])]),t._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("sysctl -w ‘kernel.core_uses_pid=1’\nsysctl -w ‘kernel.core_pattern=core.%p’\n")])])])]),t._v(" "),a("ul",[a("li",[t._v("Configure system to change max size of core files. In "),a("span",{staticClass:"notranslate"},[t._v("/etc/security/limits.conf")]),t._v(" add:")])]),t._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("user1 soft core unlimited\nuser1 hard core unlimited\n")])])])]),t._v("\nwhere "),a("span",{staticClass:"notranslate"},[t._v("user1")]),t._v(" is the username for which lsphp crashes.\n"),a("ul",[a("li",[t._v("If "),a("span",{staticClass:"notranslate"},[t._v("/etc/profile.d/limits.sh")]),t._v(" exists, look up for the following lines:")])]),t._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('if [ "$LIMITUSER" != "root" ]; then\nulimit -n 100 -u 35 -m 200000 -d 200000 -s 8192 -c 200000 -v unlimited 2>/dev/null\n')])])])]),t._v("\nSubstring "),a("span",{staticClass:"notranslate"},[t._v("“-c 200000”")]),t._v(" must be replaced with "),a("span",{staticClass:"notranslate"},[t._v("“-c unlimited”")]),t._v(" .\n"),a("ul",[a("li",[a("p",[t._v("Add line into "),a("span",{staticClass:"notranslate"},[t._v("ulimit -c unlimited into apachectl")]),t._v(" script just after another invokes of the "),a("span",{staticClass:"notranslate"},[t._v("ulimit")]),t._v(" command.")])]),t._v(" "),a("li",[a("p",[t._v("Do cold restart of Apache with the command like this:")])])]),t._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("service httpd stop; sleep 2; killall lsphp; service httpd start\n")])])])]),t._v(" "),a("ul",[a("li",[t._v("You can make sure that ulimit for lsphp is changed to unlimited successfully with the following command:")])]),t._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("cat /proc/PID/limits | grep ‘Max core file size’\n")])])])]),t._v(" "),a("p",[t._v("where PID is a pid of any lsphp process. "),a("span",{staticClass:"notranslate"},[t._v("ps -u user1 | grep lsphp ")])]),t._v(" "),a("ul",[a("li",[t._v("Core dump of lsphp will be created in the DocumentRoot of the corresponding virtual server.\nOn cPanel server it should map to")])]),t._v(" "),a("p",[a("strong",[t._v("mod_lsapi is not included in output of httpd -M after installation and setup command for cPanel EasyApache 3")])]),t._v(" "),a("ol",[a("li",[a("p",[t._v("Check if the file "),a("span",{staticClass:"notranslate"},[a("em",[t._v("/usr/local/apache/conf/conf.d/lsapi.conf")])]),t._v(" exists and not empty;")])]),t._v(" "),a("li",[a("p",[t._v("Check if output of the command")])])]),t._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('cat /usr/local/apache/conf/httpd.conf | grep "/usr/local/apache/conf/conf.d/\\*\\.conf"\n')])])])]),t._v("\nis not empty.\n"),a("p",[t._v("If it is empty:")]),t._v(" "),a("ol",[a("li",[t._v("Add to "),a("span",{staticClass:"notranslate"},[t._v(' "include" ')]),t._v(" section of "),a("span",{staticClass:"notranslate"},[a("em",[t._v("/var/cpanel/conf/apache/main")])]),t._v(" string:")])]),t._v(" "),a("p",[a("span",{staticClass:"notranslate"})]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('"include": \'"/usr/local/apache/conf/conf.d/*.conf"\'\n "include":\n "directive": \'include\'\n "items":\n ...\n -\n "include": \'"/usr/local/apache/conf/conf.d/*.conf"\' \n "listen":\n')])])]),a("ol",{attrs:{start:"2"}},[a("li",[t._v("Do:")])]),t._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("mkdir -p /usr/local/apache/conf/conf.d/;                                                                                 \ncp /usr/share/lve/modlscapi/confs/lsapi.conf /usr/local/apache/conf/conf.d/lsapi.conf\n")])])])]),t._v(" "),a("ol",{attrs:{start:"3"}},[a("li",[t._v("Call:")])]),t._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("/scripts/rebuildhttpdconf/scripts/restartsrv_httpd\n")])])])]),t._v(" "),a("h4",{attrs:{id:"faq-on-mod-lsapi"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#faq-on-mod-lsapi","aria-hidden":"true"}},[t._v("#")]),t._v(" FAQ on mod_lsapi")]),t._v(" "),a("p",[t._v("You can find FAQ "),a("a",{attrs:{href:"https://cloudlinux.zendesk.com/hc/articles/360025828414-Apache-mod-lsapi-PRO-FAQ",target:"_blank",rel:"noopener noreferrer"}},[t._v("here"),a("OutboundLink")],1),t._v(".")]),t._v(" "),a("h2",{attrs:{id:"criu-support"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#criu-support","aria-hidden":"true"}},[t._v("#")]),t._v(" CRIU Support")]),t._v(" "),a("p",[t._v(":::tip Note\n"),a("span",{staticClass:"notranslate"},[t._v(" CloudLinux ")]),t._v(" 7 only\n:::")]),t._v(" "),a("p",[t._v("CRIU is "),a("span",{staticClass:"notranslate"},[a("em",[t._v("Checkpoint/Restore In Userspace")])]),t._v(" , (pronounced "),a("span",{staticClass:"notranslate"},[t._v(" kree-oo ")]),t._v(" ), is a software tool for Linux operating system. Using this tool, you can freeze a running application (or part of it) and checkpoint it as a collection of files on disk. You can then use the files to restore the application and run it exactly as it was during the time of freeze (more information on the link "),a("a",{attrs:{href:"https://criu.org/Main_Page",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://criu.org/Main_Page"),a("OutboundLink")],1),t._v(" ).")]),t._v(" "),a("p",[t._v("mod_lsapi-1.1-1 is the first beta version with freezing PHP implemented. mod_lsapi now supports the following parameters:")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th"),t._v(" "),a("th"),t._v(" "),a("th"),t._v(" "),a("th")])]),t._v(" "),a("tbody",[a("tr",[a("td",[a("strong",[t._v("Option name")])]),t._v(" "),a("td",[a("strong",[t._v("Description")])]),t._v(" "),a("td",[a("strong",[t._v("Values")])]),t._v(" "),a("td",[a("strong",[t._v("Default")])])]),t._v(" "),a("tr",[a("td",[t._v("lsapi_criu")]),t._v(" "),a("td",[t._v("Enable/disable CRIU for lsphp freezing.")]),t._v(" "),a("td",[a("span",{staticClass:"notranslate"},[t._v(" On/Off ")])]),t._v(" "),a("td",[a("span",{staticClass:"notranslate"},[t._v(" Off ")])])]),t._v(" "),a("tr",[a("td",[t._v("lsapi_criu_socket_path")]),t._v(" "),a("td",[t._v("Set path to socket for communication with criu service.")]),t._v(" "),a("td",[t._v("[path to socket]")]),t._v(" "),a("td",[a("span",{staticClass:"notranslate"},[t._v(" /var/run/criu/criu_service.socket ")])])]),t._v(" "),a("tr",[a("td",[t._v("lsapi_backend_semtimedwait")]),t._v(" "),a("td",[t._v("Enable/disable flag for notification about lsphp started. This method avoid cycles of waiting for lsphp start.")]),t._v(" "),a("td",[a("span",{staticClass:"notranslate"},[t._v(" On/Off ")])]),t._v(" "),a("td",[a("span",{staticClass:"notranslate"},[t._v(" On ")])])]),t._v(" "),a("tr",[a("td",[t._v("lsapi_backend_initial_start")]),t._v(" "),a("td",[t._v("Number of request when lsphp should be freezed.")]),t._v(" "),a("td",[t._v("[number] 0 - no freezing")]),t._v(" "),a("td",[t._v("0")])]),t._v(" "),a("tr",[a("td",[t._v("lsapi_criu_use_shm")]),t._v(" "),a("td",[t._v("Method of requests counting. "),a("span",{staticClass:"notranslate"},[t._v(" Off ")]),t._v(" - use shared memory. "),a("span",{staticClass:"notranslate"},[t._v(" Signals ")]),t._v(" - use signals from child processes to parent.")]),t._v(" "),a("td",[a("span",{staticClass:"notranslate"},[t._v(" Off/Signals ")])]),t._v(" "),a("td",[a("span",{staticClass:"notranslate"},[t._v(" Off ")])])]),t._v(" "),a("tr",[a("td",[t._v("lsapi_criu_imgs_dir_path")]),t._v(" "),a("td",[t._v("Path to folder where imgs of freezed PHP will be stored.")]),t._v(" "),a("td",[t._v("[path]")]),t._v(" "),a("td",[a("span",{staticClass:"notranslate"},[t._v(" /var/run/mod_lsapi/ ")])])]),t._v(" "),a("tr",[a("td",[t._v("lsapi_criu_debug")]),t._v(" "),a("td",[t._v("Enable/Disable CRIU related debug logging.")]),t._v(" "),a("td",[a("span",{staticClass:"notranslate"},[t._v(" On/Off ")])]),t._v(" "),a("td",[a("span",{staticClass:"notranslate"},[t._v(" Off ")])])])])]),t._v(" "),a("p",[t._v("Example:\n")]),a("div",{staticClass:"notranslate"},[a("p"),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("lsapi_criu On\nlsapi_criu_socket_path /var/run/criu/criu_service.socket\nlsapi_backend_semtimedwait On\nlsapi_backend_initial_start 15\nlsapi_criu_use_shm Off\nlsapi_criu_debug Off\n")])])])]),t._v(" "),a("p",[t._v("When Apache module mod_lsapi detects CRIU enabled (lsapi_criu On) it prepares a directory for images (on the first request of virtualhost) to store ( "),a("span",{staticClass:"notranslate"},[t._v(" lsapi_criu_imgs_dir_path /var/run/mod_lsapi/[dir_name] ")]),t._v(" ), and starts lsphp process. Lsphp increases counter ( "),a("span",{staticClass:"notranslate"},[t._v(" lsapi_criu_use_shm Off|Signals ")]),t._v(" ) via shared memory or signals, when counter reaches limit ( "),a("span",{staticClass:"notranslate"},[t._v(" lsapi_backend_initial_start 15 ")]),t._v(" ), lsphp sends the request to CRIU for freezing. CRIU service makes images of requested processes. Lsphp will not be frozen if counter has not reached the limit. The next time when lsphp will be stopped, it will be unfrozen from the images.")]),t._v(" "),a("p",[t._v("The images of the processes will be saved even if Apache is restarted. But all images will be deleted after server restart by default configuration. This can be modified by setting the new path "),a("span",{staticClass:"notranslate"},[t._v(" lsapi_criu_imgs_dir_path ")]),t._v(" .")]),t._v(" "),a("p",[a("strong",[t._v("Important!")]),t._v(" If php.ini or configuration file from php.d is changed, the images must be deleted manually.")]),t._v(" "),a("p",[a("strong",[t._v("Note")]),t._v(" that CRIU (version lower than criu-lve-3.6-1) can't correctly freeze "),a("span",{staticClass:"notranslate"},[t._v(" lsphp ")]),t._v(" with "),a("span",{staticClass:"notranslate"},[t._v(" PrivateTmp ")]),t._v(" enabled. For correct work, "),a("span",{staticClass:"notranslate"},[t._v(" PrivateTmp ")]),t._v(" must be "),a("span",{staticClass:"notranslate"},[t._v(" false ")]),t._v(" in "),a("span",{staticClass:"notranslate"},[t._v(" httpd.service file ")]),t._v(" . For disabling:")]),t._v(" "),a("p",[t._v("Copy "),a("span",{staticClass:"notranslate"},[a("em",[t._v("httpd.service")])]),t._v(" to "),a("span",{staticClass:"notranslate"},[a("em",[t._v("/etc/systemd/system")])]),t._v(" and change there "),a("span",{staticClass:"notranslate"},[t._v(" PrivateTmp:\n  ")])]),a("div",{staticClass:"notranslate"},[a("p"),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("# cat httpd.service\n[Unit]\nDescription=Apache web server managed by cPanel Easy\nApacheConditionPathExists=!/etc/httpddisable\nConditionPathExists=!/etc/apachedisable\nConditionPathExists=!/etc/httpdisable\n\n[Service]Type=forking\nExecStart=/usr/local/cpanel/scripts/restartsrv_httpd --no-verbose\nPIDFile=/var/run/apache2/httpd.pid\nPrivateTmp=false \n\n[Install]\nWantedBy=multi-user.target \n")])])])]),t._v("\nOr it would be technically better to provide a small override of service file rather than copying the whole new version in "),a("span",{staticClass:"notranslate"},[t._v(" /etc/systemd/system ")]),t._v(" "),a("p",[a("a",{attrs:{href:"http://www.freedesktop.org/software/systemd/man/systemd.unit.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://www.freedesktop.org/software/systemd/man/systemd.unit.html"),a("OutboundLink")],1)]),t._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('mkdir /etc/systemd/system/httpd.service.d\necho "[Service]" >  /etc/systemd/system/httpd.service.d/nopt.conf\necho "PrivateTmp=false" >> /etc/systemd/system/httpd.service.d/nopt.conf\n')])])])]),t._v(" "),a("p",[t._v("and")]),t._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("# systemctl daemon-reload\n")])])])]),t._v(" "),a("p",[a("strong",[t._v("Installation")])]),t._v(" "),a("p",[t._v("Criu is installed with dependency to mod_lsapi-1.1 package. To activate it:")]),t._v(" "),a("ol",[a("li",[t._v("Enable service and start it:")])]),t._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("systemctl enable criu\nsystemctl start criu\n")])])])]),t._v(" "),a("ol",{attrs:{start:"2"}},[a("li",[t._v("Edit lsapi.conf file, turn CRIU On and set some defaults:")])]),t._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("lsapi_criu On\nlsapi_criu_socket_path /var/run/criu/criu_service.socket\nlsapi_backend_semtimedwait On\nlsapi_backend_initial_start 15\nlsapi_criu_use_shm Off\n")])])])]),t._v(" "),a("ol",{attrs:{start:"3"}},[a("li",[t._v("Restart apache:")])]),t._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("service httpd restart\n")])])])]),t._v(" "),a("ol",[a("li",[t._v("An option added to the Apache configuration for cleaning all the images earlier saved by CRIU.")])]),t._v(" "),a("table",[a("thead",[a("tr",[a("th"),t._v(" "),a("th"),t._v(" "),a("th"),t._v(" "),a("th")])]),t._v(" "),a("tbody",[a("tr",[a("td",[a("strong",[t._v("Option name")])]),t._v(" "),a("td",[a("strong",[t._v("Description")])]),t._v(" "),a("td",[a("strong",[t._v("Value")])]),t._v(" "),a("td",[a("strong",[t._v("Default")])])]),t._v(" "),a("tr",[a("td",[a("span",{staticClass:"notranslate"},[t._v("lsapi_reset_criu_on_apache_restart")])]),t._v(" "),a("td",[t._v("This option allows cleaning all CRIU images on Apache restart.")]),t._v(" "),a("td",[a("span",{staticClass:"notranslate"},[t._v(" On/Off ")])]),t._v(" "),a("td",[a("span",{staticClass:"notranslate"},[t._v(" Off ")])])])])]),t._v(" "),a("p",[t._v("On the next restart of Apache all of the images will be cleaned.")]),t._v(" "),a("p",[t._v("It can be enabled by writing "),a("span",{staticClass:"notranslate"},[t._v("lsapi_reset_criu_on_apache_restart On ")]),t._v(" in "),a("em",[t._v("lsapi.conf")]),t._v(" (Virtual Host and .htaccess do not allow to use this option).")]),t._v(" "),a("p",[t._v("Note that this option works only if "),a("span",{staticClass:"notranslate"},[t._v("lsapi_terminate_backends_on_exit")]),t._v(" is "),a("span",{staticClass:"notranslate"},[t._v("  On  ")]),t._v(" (default value is "),a("span",{staticClass:"notranslate"},[t._v(" On ")]),t._v(" , it is set in "),a("em",[t._v("lsapi.conf")]),t._v(" too).")]),t._v(" "),a("ol",{attrs:{start:"2"}},[a("li",[a("p",[t._v("If you need to clean CRIU images for one user you can simply add file to the user's directory with CRIU images (default "),a("span",{staticClass:"notranslate"},[a("em",[t._v("/var/run/mod_lsapi/lsapi")]),t._v(" * "),a("em",[t._v("criu_imgs")])]),t._v(" ). On the next restart of lsphp the images will be cleaned.")])]),t._v(" "),a("li",[a("p",[t._v("Global reset flag for cleaning all earlier saved images by CRIU.")])])]),t._v(" "),a("p",[t._v("Current mod_lsapi allows cleaning all images only with one flag file.")]),t._v(" "),a("p",[t._v("Create "),a("span",{staticClass:"notranslate"},[t._v(" /usr/share/criu/mod_lsapi/lsphp.criu.reset ")]),t._v(" file. Also don't forget to set such permissions "),a("span",{staticClass:"notranslate"},[t._v(" [nobody:nobody] ")]),t._v(" (or "),a("span",{staticClass:"notranslate"},[t._v(" [apache:apache] ")]),t._v(" for non cPanel) and access mode [700] to the "),a("span",{staticClass:"notranslate"},[t._v(" /usr/share/criu/mod_lsapi ")]),t._v(" directory.")]),t._v(" "),a("p",[t._v("Steps to do :")]),t._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("mkdir /usr/share/criumkdir /usr/share/criu/mod_lsapi\nchown nobody:nobody /usr/share/criu/mod_lsapi\ntouch /usr/share/criu/mod_lsapi/lsphp.criu.reset\n")])])])]),t._v(" "),a("p",[t._v("On the next requests to all virtual hosts images will be recreated (deleted first and created again later - it depends on lsapi_backend_initial_start value).")]),t._v(" "),a("ol",{attrs:{start:"4"}},[a("li",[t._v("Аdded possibility to clean CRIU images from user space.")])]),t._v(" "),a("p",[t._v("If a user needs to clean CRIU images for lsphp, he should create a file: "),a("span",{staticClass:"notranslate"},[t._v(" ~/mod_lsapi_reset_me_[vhost_name] ")]),t._v(". Where "),a("span",{staticClass:"notranslate"},[t._v(" [vhost_name] ")]),t._v(" is a ServerName from the VirtualHost block in the configuration file. On the next restart of lsphp, the images will be cleaned.")]),t._v(" "),a("p",[a("em",[t._v("Example:")])]),t._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("cd; touch mod_lsapi_reset_me_criu.test.com\n")])])])]),t._v(" "),a("p",[t._v("where "),a("em",[t._v("vhost.conf")]),t._v(" contains:"),a("br"),t._v(" "),a("span",{staticClass:"notranslate"},[a("em",[t._v("ServerName criu.test.com")])])]),t._v(" "),a("p",[t._v("This mode is enabled by default and creates a separate lsphp process for each virtual host.")]),t._v(" "),a("p",[a("span",{staticClass:"notranslate"},[a("em",[t._v("mod_lsapi_reset_me[vhost_name]")])]),t._v(" flag will not work for a user when lsapi_per_user option is "),a("span",{staticClass:"notranslate"},[t._v(" On ")]),t._v(" .")]),t._v(" "),a("ol",{attrs:{start:"5"}},[a("li",[t._v("There is (default "),a("span",{staticClass:"notranslate"},[t._v(" off ")]),t._v(" ) option in mod_lsapi that creates only one lsphp process for a user, regardless of the number of his virtual hosts. We don't recommend to use this option with CRIU, but if you use it, make sure that your virtual hosts (under the same user) have the same environment configurations. If they are not the same, this may cause undesirable lsphp process operation.")])])])},[],!1,null,null,null);e.default=r.exports}}]);